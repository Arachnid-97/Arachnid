{
    "version": "https://jsonfeed.org/version/1",
    "title": "命运转轮 • All posts by \"imx6ull\" tag",
    "description": "不曾亏欠, 不曾辜负, 如此足矣",
    "home_page_url": "https://arachnid.cc",
    "items": [
        {
            "id": "https://arachnid.cc/6ull-kernel-transplant/",
            "url": "https://arachnid.cc/6ull-kernel-transplant/",
            "title": "imx-6ULL kernel 移植",
            "date_published": "2023-03-04T15:32:46.000Z",
            "content_html": "<blockquote>\n<p>开发平台：Ubuntu 18.04.6</p>\n<p>目标平台：imx-6ull</p>\n<p>kernel 版本：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL254cC1pbXgvbGludXgtaW14L3RyZWUvaW14XzUuNC43MF8yLjMuMA==\">linux-imx-imx_5.4.70_2.3.0</span></p>\n<p>编译工具链：gcc versions 10.3.1 20210621 (GNU Toolchain for the A-profile Architecture 10.3-2021.07 (arm-10.29))</p>\n</blockquote>\n<h1 id=\"环境搭建\"><a class=\"anchor\" href=\"#环境搭建\">#</a> 环境搭建</h1>\n<h2 id=\"交叉编译器\"><a class=\"anchor\" href=\"#交叉编译器\">#</a> 交叉编译器</h2>\n<p>关于 arm linux 交叉编译工具链的搭建，这里就再不展开说明了，毕竟在此之前如果有移植过 uboot，那么这里就可以省略了，对于没有搭过交叉编译工具链的，可以查看上一篇 <a href=\"https://arachnid.cc/6ull-uboot-transplant/\">imx-6ULL uboot 移植</a> 的交叉编译搭建的环节。</p>\n<h2 id=\"kernel-源码\"><a class=\"anchor\" href=\"#kernel-源码\">#</a> kernel 源码</h2>\n<p>NXP 维护的 kernel 仓库地址：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL254cC1pbXgvbGludXgtaW14\">https://github.com/nxp-imx/linux-imx</span></p>\n<p>获取 NXP kernel 5.4.70_2.3.0 版本的源码：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 直接拉取 5.4.70_2.3.0 版本源码文件</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">git</span> clone <span class=\"token parameter variable\">-b</span> imx_5.4.70_2.3.0 https://github.com/nxp-imx/linux-imx</pre></td></tr></table></figure><h1 id=\"编译验证\"><a class=\"anchor\" href=\"#编译验证\">#</a> 编译验证</h1>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token parameter variable\">-s</span></pre></td></tr><tr><td data-num=\"2\"></td><td data-command=\"[root@localhost] #\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">ARCH</span><span class=\"token operator\">=</span>arm</pre></td></tr><tr><td data-num=\"3\"></td><td data-command=\"[root@localhost] #\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">CROSS_COMPILE</span><span class=\"token operator\">=</span>arm-none-linux-gnueabihf-</pre></td></tr><tr><td data-num=\"4\"></td><td data-command=\"[root@localhost] #\"></td><td><pre><span class=\"token function\">make</span> distclean</pre></td></tr><tr><td data-num=\"5\"></td><td data-command=\"[root@localhost] #\"></td><td><pre><span class=\"token function\">make</span> imx_v7_defconfig</pre></td></tr><tr><td data-num=\"6\"></td><td data-command=\"[root@localhost] #\"></td><td><pre><span class=\"token function\">make</span></pre></td></tr></table></figure><p>第一次编译可能不会通过，如果出现以下报错：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>HOSTCC  scripts/extract-cert</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>scripts/extract-cert.c:21:10: fatal error: openssl/bio.h: 没有那个文件或目录</pre></td></tr><tr><td data-num=\"3\"></td><td><pre> <span class=\"token comment\">#include &lt;openssl/bio.h></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>          ^~~~~~~~~~~~~~~</pre></td></tr></table></figure><p>则需要安装相应的依赖库：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> libssl-dev</pre></td></tr></table></figure><p>出现：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/bin/sh: <span class=\"token number\">1</span>: lzop: not found</pre></td></tr></table></figure><p>安装：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> lzop</pre></td></tr></table></figure><p>最后再次编译验证，最后得到  <code>arch/arm/boot</code>  目录下的  <code>zImage</code>  内核文件以及  <code>arch/arm/boot/dts</code>  目录下所需的  <code>.dtb</code>  设备树文件。</p>\n<h1 id=\"移植\"><a class=\"anchor\" href=\"#移植\">#</a> 移植</h1>\n<h2 id=\"设备树文件\"><a class=\"anchor\" href=\"#设备树文件\">#</a> 设备树文件</h2>\n<p>1、 <code>imx6ull-14x14-lanjut-emmc.dts</code>  文件：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">ls</span> arch/arm/boot/dts/*6ull*.dts</pre></td></tr><tr><td data-num=\"2\"></td><td data-command></td><td><pre>arch/arm/boot/dts/imx6ull-14x14-evk-btwifi.dts</pre></td></tr><tr><td data-num=\"3\"></td><td data-command></td><td><pre>arch/arm/boot/dts/imx6ull-14x14-evk-btwifi-oob.dts</pre></td></tr><tr><td data-num=\"4\"></td><td data-command></td><td><pre>arch/arm/boot/dts/imx6ull-14x14-evk.dts</pre></td></tr><tr><td data-num=\"5\"></td><td data-command></td><td><pre>arch/arm/boot/dts/imx6ull-14x14-evk-emmc.dts</pre></td></tr><tr><td data-num=\"6\"></td><td data-command></td><td><pre>arch/arm/boot/dts/imx6ull-14x14-evk-gpmi-weim.dts</pre></td></tr><tr><td data-num=\"7\"></td><td data-command></td><td><pre>arch/arm/boot/dts/imx6ull-9x9-evk-btwifi.dts</pre></td></tr><tr><td data-num=\"8\"></td><td data-command></td><td><pre>arch/arm/boot/dts/imx6ull-9x9-evk-btwifi-oob.dts</pre></td></tr><tr><td data-num=\"9\"></td><td data-command></td><td><pre>arch/arm/boot/dts/imx6ull-9x9-evk.dts</pre></td></tr><tr><td data-num=\"10\"></td><td data-command></td><td><pre>arch/arm/boot/dts/imx6ull-9x9-evk-ldo.dts</pre></td></tr><tr><td data-num=\"11\"></td><td data-command></td><td><pre>arch/arm/boot/dts/imx6ull-colibri-eval-v3.dts</pre></td></tr><tr><td data-num=\"12\"></td><td data-command></td><td><pre>arch/arm/boot/dts/imx6ull-colibri-wifi-eval-v3.dts</pre></td></tr><tr><td data-num=\"13\"></td><td data-command></td><td><pre>arch/arm/boot/dts/imx6ull-phytec-segin-ff-rdk-emmc.dts</pre></td></tr><tr><td data-num=\"14\"></td><td data-command></td><td><pre>arch/arm/boot/dts/imx6ull-phytec-segin-ff-rdk-nand.dts</pre></td></tr><tr><td data-num=\"15\"></td><td data-command></td><td><pre>arch/arm/boot/dts/imx6ull-phytec-segin-lc-rdk-nand.dts</pre></td></tr><tr><td data-num=\"16\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">cp</span> arch/arm/boot/dts/imx6ull-14x14-evk-emmc.dts arch/arm/boot/dts/imx6ull-14x14-lanjut-emmc.dts</pre></td></tr><tr><td data-num=\"17\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">vim</span> arch/arm/boot/dts/imx6ull-14x14-lanjut-emmc.dts</pre></td></tr></table></figure><p><strong>修改：</strong></p>\n<p>把  <code>#include &quot;imx6ull-14x14-evk.dts&quot;</code>  更改为  <code>#include &quot;imx6ull-14x14-lanjut.dts&quot;</code>  。</p>\n<p>2、 <code>imx6ull-14x14-lanjut.dts</code>  文件：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">cp</span> arch/arm/boot/dts/imx6ull-14x14-evk.dts arch/arm/boot/dts/imx6ull-14x14-lanjut.dts</pre></td></tr><tr><td data-num=\"2\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">vim</span> arch/arm/boot/dts/imx6ull-14x14-lanjut.dts</pre></td></tr></table></figure><p><strong>修改：</strong></p>\n<p>把  <code>#include &quot;imx6ul-14x14-evk.dtsi&quot;</code>  更改为  <code>#include &quot;imx6ull-14x14-lanjut.dtsi&quot;</code>  ；</p>\n<p>同时更改以下内容：</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/ &#123;</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\tmodel = \"i.MX6 ULL 14x14 EVK Board\";</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\tcompatible = \"fsl,imx6ull-14x14-evk\", \"fsl,imx6ull\";</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>&#125;;</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>改为</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>/ &#123;</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\tmodel = \"i.MX6 ULL 14x14 LANJUT Board\";</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\tcompatible = \"fsl,imx6ull-14x14-lanjut\", \"fsl,imx6ull\";</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>&#125;;</pre></td></tr></table></figure><p>把两个  <code>status = &quot;okay&quot;;</code>  改为  <code>status = &quot;disabled&quot;;</code>  ，这里暂不需要摄像头驱动。</p>\n<p>3、  <code>imx6ull-14x14-lanjut.dtsi</code>  文件：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">cp</span> arch/arm/boot/dts/imx6ul-14x14-evk.dtsi arch/arm/boot/dts/imx6ull-14x14-lanjut.dtsi</pre></td></tr></table></figure><h2 id=\"配置文件\"><a class=\"anchor\" href=\"#配置文件\">#</a> 配置文件</h2>\n<p>在这里，imx6ull 的 kernel 默认配置文件为  <code>imx_v7_defconfig</code>  ，因此，我们独立一个专属自己的配置文件：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">cp</span> arch/arm/configs/imx_v7_defconfig arch/arm/configs/imx_v7_lanjut_defconfig</pre></td></tr></table></figure><p><strong>修改：</strong></p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>去除其它芯片类型的设备树的生成</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>CONFIG_SOC_IMX50=y</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>CONFIG_SOC_IMX51=y</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>CONFIG_SOC_IMX53=y</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>CONFIG_SOC_IMX6Q=y</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>CONFIG_SOC_IMX6SL=y</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>CONFIG_SOC_IMX6SLL=y</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>CONFIG_SOC_IMX6SX=y</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>CONFIG_SOC_IMX6UL=y</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>CONFIG_SOC_IMX7D=y</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>CONFIG_SOC_IMX7ULP=y</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>CONFIG_SOC_VF610=y</pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>改为</pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre># CONFIG_SOC_IMX50 is not set</pre></td></tr><tr><td data-num=\"18\"></td><td><pre># CONFIG_SOC_IMX51 is not set</pre></td></tr><tr><td data-num=\"19\"></td><td><pre># CONFIG_SOC_IMX53 is not set</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>CONFIG_SOC_IMX6Q=y</pre></td></tr><tr><td data-num=\"21\"></td><td><pre># CONFIG_SOC_IMX6SL is not set</pre></td></tr><tr><td data-num=\"22\"></td><td><pre># CONFIG_SOC_IMX6SLL is not set</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>CONFIG_SOC_IMX6SX=y</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>CONFIG_SOC_IMX6UL=y</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>CONFIG_SOC_IMX7D=y</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>CONFIG_SOC_IMX7ULP=y</pre></td></tr><tr><td data-num=\"27\"></td><td><pre># CONFIG_SOC_VF610 is not set</pre></td></tr></table></figure><p>这里除了  <code>CONFIG_SOC_IMX6UL</code>  还有几个是必须的，否则编译不过，还有其它关联的直接屏蔽：</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre># CONFIG_MTD_NAND_VF610_NFC=y</pre></td></tr><tr><td data-num=\"2\"></td><td><pre># CONFIG_NVMEM_VF610_OCOTP=y</pre></td></tr></table></figure><p>最后，添加一个热插拔管理：</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>CONFIG_UEVENT_HELPER=y</pre></td></tr></table></figure><p>然后，这个配置文件其它东西我们就先不去更改了，因为内核配置太多太复杂了，它们之间的功能关系也很难分清，后面我们使用图形配置操作对需要的功能进行增删。</p>\n<h2 id=\"其它文件\"><a class=\"anchor\" href=\"#其它文件\">#</a> 其它文件</h2>\n<p>为  <code>Makefile</code>  添加新增的文件编译：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">vim</span> arch/arm/boot/dts/Makefile</pre></td></tr></table></figure><p><strong>修改：</strong></p>\n<figure class=\"highlight makefile\"><figcaption data-lang=\"makefile\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>dtb-<span class=\"token variable\">$</span><span class=\"token punctuation\">(</span>CONFIG_SOC_IMX6UL<span class=\"token punctuation\">)</span> <span class=\"token operator\">+=</span> \\</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\timx6ul-14x14-evk.dtb \\</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\timx6ul-14x14-evk-csi.dtb \\</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\timx6ul-14x14-evk-emmc.dtb \\</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\timx6ul-14x14-evk-btwifi.dtb \\</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\timx6ul-14x14-evk-btwifi-oob.dtb \\</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\timx6ul-14x14-evk-ecspi-slave.dtb \\</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\timx6ul-14x14-evk-ecspi.dtb \\</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\timx6ul-14x14-evk-gpmi-weim.dtb \\</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\timx6ul-9x9-evk.dtb \\</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\timx6ul-9x9-evk-ldo.dtb \\</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\timx6ul-9x9-evk-btwifi.dtb \\</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\timx6ul-9x9-evk-btwifi-oob.dtb \\</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\timx6ul-ccimx6ulsbcexpress.dtb \\</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\timx6ul-ccimx6ulsbcpro.dtb \\</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\timx6ul-geam.dtb \\</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\timx6ul-isiot-emmc.dtb \\</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\timx6ul-isiot-nand.dtb \\</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\timx6ul-kontron-n6310-s.dtb \\</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\timx6ul-kontron-n6310-s-43.dtb \\</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\timx6ul-liteboard.dtb \\</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>\timx6ul-opos6uldev.dtb \\</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>\timx6ul-pico-hobbit.dtb \\</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>\timx6ul-pico-pi.dtb \\</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>\timx6ul-phytec-segin-ff-rdk-nand.dtb \\</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>\timx6ul-tx6ul-0010.dtb \\</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>\timx6ul-tx6ul-0011.dtb \\</pre></td></tr><tr><td data-num=\"28\"></td><td><pre>\timx6ul-tx6ul-mainboard.dtb \\</pre></td></tr><tr><td data-num=\"29\"></td><td><pre>\timx6ull-14x14-evk.dtb \\</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>\timx6ull-14x14-evk-emmc.dtb \\</pre></td></tr><tr><td data-num=\"31\"></td><td><pre>\timx6ull-14x14-evk-btwifi.dtb \\</pre></td></tr><tr><td data-num=\"32\"></td><td><pre>\timx6ull-14x14-evk-btwifi-oob.dtb \\</pre></td></tr><tr><td data-num=\"33\"></td><td><pre>\timx6ull-14x14-evk-gpmi-weim.dtb \\</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>\timx6ull-14x14-lanjut-emmc.dtb \\  <span class=\"token comment\"># 将设备树文件添加进编译项</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>\timx6ull-9x9-evk.dtb \\</pre></td></tr><tr><td data-num=\"36\"></td><td><pre>\timx6ull-9x9-evk-ldo.dtb \\</pre></td></tr><tr><td data-num=\"37\"></td><td><pre>\timx6ull-9x9-evk-btwifi.dtb \\</pre></td></tr><tr><td data-num=\"38\"></td><td><pre>\timx6ull-9x9-evk-btwifi-oob.dtb \\</pre></td></tr><tr><td data-num=\"39\"></td><td><pre>\timx6ull-colibri-eval-v3.dtb \\</pre></td></tr><tr><td data-num=\"40\"></td><td><pre>\timx6ull-colibri-wifi-eval-v3.dtb \\</pre></td></tr><tr><td data-num=\"41\"></td><td><pre>\timx6ull-phytec-segin-ff-rdk-nand.dtb \\</pre></td></tr><tr><td data-num=\"42\"></td><td><pre>\timx6ull-phytec-segin-ff-rdk-emmc.dtb \\</pre></td></tr><tr><td data-num=\"43\"></td><td><pre>\timx6ull-phytec-segin-lc-rdk-nand.dtb \\</pre></td></tr><tr><td data-num=\"44\"></td><td><pre>\timx6ulz-14x14-evk.dtb \\</pre></td></tr><tr><td data-num=\"45\"></td><td><pre>\timx6ulz-14x14-evk-btwifi.dtb \\</pre></td></tr><tr><td data-num=\"46\"></td><td><pre>\timx6ulz-14x14-evk-gpmi-weim.dtb \\</pre></td></tr><tr><td data-num=\"47\"></td><td><pre>\timx6ulz-14x14-evk-emmc.dtb</pre></td></tr></table></figure><h1 id=\"外设配置\"><a class=\"anchor\" href=\"#外设配置\">#</a> 外设配置</h1>\n<p>这里不多阐述了，主要是根据你的硬件进行修改，是对设备树、功能配置、函数修改的操作。</p>\n<h1 id=\"配置内核\"><a class=\"anchor\" href=\"#配置内核\">#</a> 配置内核</h1>\n<h2 id=\"图形配置\"><a class=\"anchor\" href=\"#图形配置\">#</a> 图形配置</h2>\n<p>需要先  <code>make xxx_config</code>  生成  <code>.config</code>  。</p>\n<p>使用  <code>make menuconfig</code>  调出图形配置界面进行配置；如果  <code>make menuconfig</code>  失败，说明缺少  <code>ncurses</code>  库 ，需要安装  <code>libncurses-dev</code>  ，在安装前则需要加载  <code>libncurses-dev</code>  的<span class=\"exturl\" data-url=\"aHR0cHM6Ly9wYWNrYWdlcy51YnVudHUuY29tL2ZvY2FsL2FtZDY0L2xpYm5jdXJzZXMtZGV2L2Rvd25sb2Fk\">源镜像</span>，然后通过  <code>apt update</code>  更新，然后再次使用命令  <code>apt install libncurses-dev </code>  安装，若安装后还不行，可能是由于某些库可能没安装好，或者被  <code>auto remove</code>  掉了，可以尝试以下安装：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">apt</span> <span class=\"token function\">install</span> lib32ncurses5 lib32ncurses5-dev lib32ncursesw5 lib32ncursesw5-dev lib32tinfo-dev lib32tinfo5 libcunit1-ncurses libcunit1-ncurses-dev libncurses5 libncurses5-dbg libncurses5-dev libncursesw5 libncursesw5-dbg libncursesw5-dev</pre></td></tr></table></figure><p>当进入图形菜单后，可以通过以下热键进行选择：</p>\n<ul>\n<li><code>Y</code>  显示为 [*] 。模块驱动编译到内核中，启动时自动加载。</li>\n<li><code>N</code>  显示为 [ ] 。移除该模块驱动。</li>\n<li><code>M</code>  显示为 [M] 。模块会被编译，但是不会被编译到内核中，只是生成  <code>.o</code>  /  <code>.ko</code>  文件，通过  <code>insmod</code>  命令实现动态加载。</li>\n</ul>\n<p>note：如果想要 Load 加载原有的配置信息，那么需要先  <code>make zImage</code>  才能获取回来。</p>\n<h1 id=\"添加编译脚本\"><a class=\"anchor\" href=\"#添加编译脚本\">#</a> 添加编译脚本</h1>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">touch</span> build.sh</pre></td></tr><tr><td data-num=\"2\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">vim</span> build.sh</pre></td></tr></table></figure><p><strong>写入：</strong></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token shebang important\">#!/bin/bash</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 若之前已经导入到环境变量则不需要</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token environment constant\">$PATH</span>:/usr/local/arm/gcc-arm-10.3-2021.07-x86_64-arm-none-linux-gnueabihf/bin</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># 若已经在顶层 Makefile 文件中指定则不需要</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">ARCH</span><span class=\"token operator\">=</span>arm</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># 若已经在顶层 Makefile 文件中指定则不需要</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">CROSS_COMPILE</span><span class=\"token operator\">=</span>arm-none-linux-gnueabihf-</pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token function\">make</span> distclean</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token function\">make</span> mx6ull_14x14_lanjut_emmc_defconfig</pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">make</span> zImage -j<span class=\"token variable\"><span class=\"token variable\">$(</span>nproc<span class=\"token variable\">)</span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token function\">make</span> dtbs -j<span class=\"token variable\"><span class=\"token variable\">$(</span>nproc<span class=\"token variable\">)</span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token function\">make</span> modules -j<span class=\"token variable\"><span class=\"token variable\">$(</span>nproc<span class=\"token variable\">)</span></span></pre></td></tr></table></figure><h1 id=\"附\"><a class=\"anchor\" href=\"#附\">#</a> 附</h1>\n<p>kernel 文件结构：</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">类型</th>\n<th style=\"text-align:center\">名称</th>\n<th style=\"text-align:center\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\" rowspan=\"22\">文件夹</td>\n<td style=\"text-align:center\">arch</td>\n<td style=\"text-align:center\">与架构体系相关</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">block</td>\n<td style=\"text-align:center\">块设备相关</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">certs</td>\n<td style=\"text-align:center\">内核签名相关</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">crypto</td>\n<td style=\"text-align:center\">加密相关</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Documentation</td>\n<td style=\"text-align:center\">各说明文档</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">drivers</td>\n<td style=\"text-align:center\">驱动相关</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">fs</td>\n<td style=\"text-align:center\">文件系统相关</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">include</td>\n<td style=\"text-align:center\">头文件相关</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">init</td>\n<td style=\"text-align:center\">初始化相关</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">ipc</td>\n<td style=\"text-align:center\">进程间通信相关</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">kernel</td>\n<td style=\"text-align:center\">内核相关</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">lib</td>\n<td style=\"text-align:center\">lib 库文件</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">LICENSES</td>\n<td style=\"text-align:center\">许可证相关</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">mm</td>\n<td style=\"text-align:center\">内存管理相关</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">net</td>\n<td style=\"text-align:center\">网络相关</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">samples</td>\n<td style=\"text-align:center\">例程相关</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">scripts</td>\n<td style=\"text-align:center\">相关脚本</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">security</td>\n<td style=\"text-align:center\">内核安全模型相关</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">sound</td>\n<td style=\"text-align:center\">音频处理相关</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">tools</td>\n<td style=\"text-align:center\">kernel 构建工具相关</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">usr</td>\n<td style=\"text-align:center\">早期用户空间代码（与 initramfs 文件相关）</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">virt</td>\n<td style=\"text-align:center\">内核虚拟机 KVM</td>\n</tr>\n<tr>\n<td style=\"text-align:center\" rowspan=\"7\">文件</td>\n<td style=\"text-align:center\">COPYING</td>\n<td style=\"text-align:center\">版权声明</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">CREDITS</td>\n<td style=\"text-align:center\">贡献者名单</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Kbuild</td>\n<td style=\"text-align:center\">Makefile 引用文件</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Kconfig</td>\n<td style=\"text-align:center\">图形配置界面相关文件</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">MAINTAINERS</td>\n<td style=\"text-align:center\">开发及维护记录</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Makefile</td>\n<td style=\"text-align:center\">主 Makefile 脚本</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">README</td>\n<td style=\"text-align:center\">工程说明</td>\n</tr>\n</tbody>\n</table>\n",
            "tags": [
                "Linux",
                "arm_linux",
                "imx6ull"
            ]
        },
        {
            "id": "https://arachnid.cc/6ull-uboot-transplant/",
            "url": "https://arachnid.cc/6ull-uboot-transplant/",
            "title": "imx-6ULL uboot 移植",
            "date_published": "2023-03-03T12:52:11.803Z",
            "content_html": "<blockquote>\n<p>开发平台：Ubuntu 18.04.6</p>\n<p>目标平台：imx-6ull</p>\n<p>uboot 版本：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL254cC1pbXgvdWJvb3QtaW14L3RyZWUvaW14X3YyMDIwLjA0XzUuNC43MF8yLjMuMA==\">uboot-imx-imx_v2020.04_5.4.70_2.3.0</span></p>\n<p>编译工具链：gcc versions 10.3.1 20210621 (GNU Toolchain for the A-profile Architecture 10.3-2021.07 (arm-10.29))</p>\n</blockquote>\n<h1 id=\"环境搭建\"><a class=\"anchor\" href=\"#环境搭建\">#</a> 环境搭建</h1>\n<h2 id=\"交叉编译器\"><a class=\"anchor\" href=\"#交叉编译器\">#</a> 交叉编译器</h2>\n<p>在 ARM <span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZXZlbG9wZXIuYXJtLmNvbS9kb3dubG9hZHMvLS9nbnUtYQ==\">官方链接</span>下载 Arm A-profile architecture 编译工具链，选择自己相应的平台，这里的话是： <code>gcc-arm-10.3-2021.07-x86_64-arm-none-linux-gnueabihf</code>  。</p>\n<p>解压添加至本地：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command></td><td><pre><span class=\"token comment\"># 创建存放编译工具链的文件夹</span></pre></td></tr><tr><td data-num=\"2\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">mkdir</span> /usr/local/arm</pre></td></tr><tr><td data-num=\"3\"></td><td data-command></td><td><pre><span class=\"token comment\"># 移动文件</span></pre></td></tr><tr><td data-num=\"4\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">mv</span> gcc-arm-10.3-2021.07-x86_64-arm-none-linux-gnueabihf.tar.xz /usr/local/arm/</pre></td></tr><tr><td data-num=\"5\"></td><td data-command></td><td><pre><span class=\"token comment\"># 解压文件</span></pre></td></tr><tr><td data-num=\"6\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">tar</span> <span class=\"token parameter variable\">-xvf</span> /usr/local/arm/gcc-arm-10.3-2021.07-x86_64-arm-none-linux-gnueabihf.tar.xz</pre></td></tr></table></figure><p>添加环境变量：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command></td><td><pre><span class=\"token comment\"># 添加到系统环境变量 (对所有用户有效)</span></pre></td></tr><tr><td data-num=\"2\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">vim</span> /etc/profile</pre></td></tr><tr><td data-num=\"3\"></td><td data-command></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token environment constant\">$PATH</span>:/usr/local/arm/gcc-arm-10.3-2021.07-x86_64-arm-none-linux-gnueabihf/bin</pre></td></tr><tr><td data-num=\"4\"></td><td data-command></td><td><pre><span class=\"token comment\"># 添加到用户环境变量 (仅对当前用户有效)</span></pre></td></tr><tr><td data-num=\"5\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">vim</span> ~/.bashrc </pre></td></tr><tr><td data-num=\"6\"></td><td data-command></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token environment constant\">$PATH</span>:/usr/local/arm/gcc-arm-10.3-2021.07-x86_64-arm-none-linux-gnueabihf/bin</pre></td></tr><tr><td data-num=\"7\"></td><td data-command></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td data-command></td><td><pre><span class=\"token comment\"># 以上二选一</span></pre></td></tr></table></figure><p>测试命令：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command></td><td><pre><span class=\"token comment\"># 成功打印版本信息则为通过</span></pre></td></tr><tr><td data-num=\"2\"></td><td data-command=\"[user@localhost] #\"></td><td><pre>arm-none-linux-gnueabihf-gcc <span class=\"token parameter variable\">-v</span></pre></td></tr></table></figure><h2 id=\"uboot-源码\"><a class=\"anchor\" href=\"#uboot-源码\">#</a> uboot 源码</h2>\n<p>NXP 维护的 uboot 仓库地址：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL254cC1pbXgvdWJvb3QtaW14\">https://github.com/nxp-imx/uboot-imx</span></p>\n<p>获取 NXP uboot 5.4.70_2.3.0 版本的源码：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 拉取源码文件</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">git</span> clone https://github.com/nxp-imx/uboot-imx.git</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 切换到</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">git</span> checkout imx_v2020.04_5.4.70_2.3.0</pre></td></tr></table></figure><p>上面的 clone 操作会拉取所有分支文件及历史提交信息下来，文件比较大，如果网络不太好，可以尝试打开 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL254cC1pbXgvdWJvb3QtaW14L3RyZWUvaW14X3YyMDIwLjA0XzUuNC43MF8yLjMuMA==\">https://github.com/nxp-imx/uboot-imx/tree/imx_v2020.04_5.4.70_2.3.0</span> 只下载 ZIP 压缩包下来，然后利用  <code>unzip</code>  命令解压。</p>\n<p>或者使用  <code>git clone -b imx_v2020.04_5.4.70_2.3.0 https://github.com/nxp-imx/uboot-imx.git</code>  直接下载指定版本。</p>\n<p>note：对于不同分支，有  <code>fslc</code>  和  <code>imx</code>  关键字的区分，以下摘录解释：</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>There are two BSPs, the BSP Releases which are supported by NXP and their documentation can be found on the Linux i.MX webpage, and the Community BSP.</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>A BSP Release roadmap is not publicly available, but as you may see there are new BSPs every several months. However, it usually lags in respect to the Linux Mainline Kernel as a lot of work is done to ensure that the kernel works correctly on the NXP hardware. The kernel from these BSP Releases (linux-imx) can be found on the following repository and it is indeed an upstream from the Community BSP Kernel.</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>https://source.codeaurora.org/external/imx/linux-imx/</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>As for the Community BSP, it’s constantly being updated by the Community but due to its nature is hard to predict how fast each branch will be developed.</pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>You can find more information about the Community BSP on the link below:</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>http://freescale.github.io/</pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>The Kernel recipes of the community BSP (linux-fslc) would be on the meta-freescale layer:</pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>http://git.yoctoproject.org/cgit/cgit.cgi/meta-freescale</pre></td></tr></table></figure><p>简单的来讲，就是  <code>imx</code>  是官方发行版，而  <code>fslc</code>  是社区发行版。</p>\n<p>来源：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9jb21tdW5pdHkubnhwLmNvbS90NS9pLU1YLVByb2Nlc3NvcnMvd2hhdC1pcy10aGUtcHVycG9zZS1vZi1saW51eC1mc2xjLWdpdC9tLXAvMTA0NzYwMg==\">https://community.nxp.com/t5/i-MX-Processors/what-is-the-purpose-of-linux-fslc-git/m-p/1047602</span></p>\n<p>关于 uboot 版本选择：</p>\n<p>随着时间的变化，uboot 的更新也出现了多个的版本，那么到底应该选择哪一个呢？有些人可能会说当然是越新越好啦。其实呢不是这个样子的，虽然 uboot 本身是在不断的开发和进化当中，但对于新版本来说，可能开发者们在某一个版本中加入了一些新的特性，然后呢过了一段时间又发现这个新功能不是很稳定，就有可能会把它删掉或者需要后期继续更新迭代修复；这样一来就会对我们所移植的 uboot 来说就会增加很多不必要的复杂性，因为不排除是否会影响到所使用的功能，所以一般的原则就是够用就可以了，不需要频繁更新。</p>\n<p>那如何选择属于自己的版本呢：</p>\n<ol>\n<li>\n<p>打开下载的 uboot 目录下的： <code>arch/arm/cpu</code>  目录，确认使用的 cpu 型号是否支持及对应。</p>\n</li>\n<li>\n<p>打开 uboot 目录下的： <code>board</code>  目录，查看相对应的外设是否都支持。eq： <code>board/freescale/mx6ull_board/</code>  。</p>\n</li>\n</ol>\n<p>一般来说，uboot 版本越新支持的开发板和 cpu 就越多，代码量就越多，如果我们的 cpu 和开发板的并没有这么多东西，那我们可以不用新的。而用适合自己产品外设的，通常是根据开发板发行的日期和 uboot 的更新日期来找到合适的 uboot。</p>\n<h1 id=\"编译验证\"><a class=\"anchor\" href=\"#编译验证\">#</a> 编译验证</h1>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token parameter variable\">-s</span></pre></td></tr><tr><td data-num=\"2\"></td><td data-command=\"[root@localhost] #\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">ARCH</span><span class=\"token operator\">=</span>arm</pre></td></tr><tr><td data-num=\"3\"></td><td data-command=\"[root@localhost] #\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">CROSS_COMPILE</span><span class=\"token operator\">=</span>arm-none-linux-gnueabihf-</pre></td></tr><tr><td data-num=\"4\"></td><td data-command=\"[root@localhost] #\"></td><td><pre><span class=\"token function\">make</span> distclean</pre></td></tr><tr><td data-num=\"5\"></td><td data-command=\"[root@localhost] #\"></td><td><pre><span class=\"token function\">make</span> mx6ull_14x14_evk_emmc_defconfig</pre></td></tr><tr><td data-num=\"6\"></td><td data-command=\"[root@localhost] #\"></td><td><pre><span class=\"token function\">make</span></pre></td></tr></table></figure><p>编译源码这一步的目的：</p>\n<ul>\n<li>一是为了验证编译环境是否正常；</li>\n<li>二是为了下一步移植过程中的代码分析（一些文件只有在编译后才会生成）。</li>\n</ul>\n<p>note：</p>\n<p><code>make clean</code>  - 清除了目标机器上可以运行的 bin 文件以及目录，还有中间的过程文件和编译日志，但是会保留内核的配置文件 .config 以及编译支持的扩展模块；</p>\n<p><code>make mrproper</code>  - 在 clean 的基础上，清除了交叉编译工具链、menuconfig 的内容；</p>\n<p><code>make distclean</code>  - 在 mrproper 的基础上，删除编辑器备份和补丁文件。</p>\n<p>删除的文件范围从小到大依次为：  <code>make clean</code>  &lt;  <code>make mrproper</code>  &lt;  <code>make distclean</code>  。</p>\n<p>注意：</p>\n<p>若是提示  <code>make: 未找到命令</code>  ，则需要安装  <code>make</code>  工具：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> <span class=\"token function\">make</span></pre></td></tr></table></figure><p>若是出现  <code>/bin/sh: 1: cc: not found</code>  ，需要安装 gcc 依赖，因为  <code>HOSTCC  scripts/basic/fixdep</code>  强制定义使用了 gcc， <code>HOSTCC=gcc</code>  ：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> gcc</pre></td></tr></table></figure><p>若是在系统上第一次编译 uboot 源码可能会遇到缺少   <code>bison</code> 、 <code>flex</code>  的报错信息导致编译失败，只需安装相应的工具包后重新执行编译即可：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command></td><td><pre><span class=\"token comment\"># 语法分析工具</span></pre></td></tr><tr><td data-num=\"2\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> bison</pre></td></tr><tr><td data-num=\"3\"></td><td data-command></td><td><pre><span class=\"token comment\"># 词法分析工具</span></pre></td></tr><tr><td data-num=\"4\"></td><td data-command=\"[user@localhost] #\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> flex</pre></td></tr></table></figure><p>最后再次编译验证，最后得到主目录下的  <code>u-boot-dtb.imx</code>  镜像文件。</p>\n<h1 id=\"移植\"><a class=\"anchor\" href=\"#移植\">#</a> 移植</h1>\n<p>下面以命名为  <code>lanjut</code>  的板子为例。</p>\n<h2 id=\"开发板文件夹\"><a class=\"anchor\" href=\"#开发板文件夹\">#</a> 开发板文件夹</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">ls</span> <span class=\"token parameter variable\">-d</span> board/freescale/*6ull*</pre></td></tr><tr><td data-num=\"2\"></td><td data-command></td><td><pre>board/freescale/mx6ullevk     board/freescale/mx6ull_ddr3_val</pre></td></tr><tr><td data-num=\"3\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">cp</span> <span class=\"token parameter variable\">-r</span> board/freescale/mx6ullevk/ board/freescale/mx6ull_lanjut/</pre></td></tr><tr><td data-num=\"4\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">mv</span> board/freescale/mx6ull_lanjut/mx6ullevk.c board/freescale/mx6ull_lanjut/mx6ull_lanjut.c</pre></td></tr><tr><td data-num=\"5\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">ls</span> board/freescale/mx6ull_lanjut/</pre></td></tr><tr><td data-num=\"6\"></td><td data-command></td><td><pre>imximage.cfg         Kconfig      Makefile        plugin.S</pre></td></tr><tr><td data-num=\"7\"></td><td data-command></td><td><pre>imximage_lpddr2.cfg  MAINTAINERS  mx6ull_lanjut.c  README</pre></td></tr></table></figure><p><strong>修改：</strong></p>\n<p>1、 <code>Kconfig</code>  文件：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">vim</span> board/freescale/mx6ull_lanjut/Kconfig</pre></td></tr></table></figure><p>更改内容为（注意该文件  <code>endif</code>  后面必须有换行）：</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>if TARGET_MX6ULL_14X14_LANJUT</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>config SYS_BOARD</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\tdefault \"mx6ull_lanjut\"</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>config SYS_VENDOR</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\tdefault \"freescale\"</pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>config SYS_CONFIG_NAME</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\tdefault \"mx6ull_lanjut\"</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>config SYS_TEXT_BASE</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\tdefault 0x87800000</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>endif</pre></td></tr></table></figure><p>2、 <code>Makefile</code>  文件：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">vim</span> board/freescale/mx6ull_lanjut/Makefile</pre></td></tr></table></figure><p>把  <code>obj-y  := mx6ullevk.o</code>  改为  <code>obj-y  := mx6ull_lanjut.o</code>  。</p>\n<p>3、 <code>imximage_lpddr2.cfg</code>  和  <code>imximage.cfg</code>  文件：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">vim</span> board/freescale/mx6ull_lanjut/imximage_lpddr2.cfg</pre></td></tr><tr><td data-num=\"2\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">vim</span> board/freescale/mx6ull_lanjut/imximage.cfg</pre></td></tr></table></figure><p>该更改受控于  <code>CONFIG_USE_IMXIMG_PLUGIN</code>  宏定义，在配置文件中是没有使能的，改不改都无所谓，但为了统一，把  <code>PLUGIN\tboard/freescale/mx6ullevk/plugin.bin 0x00907000</code>  改为  <code>PLUGIN\tboard/freescale/mx6ull_lanjut/plugin.bin 0x00907000</code>  。</p>\n<p>4、 <code>MAINTAINERS</code>  文件：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">vim</span> board/freescale/mx6ull_lanjut/MAINTAINERS</pre></td></tr></table></figure><p>是维护者记录文件，作为个人使用，改不改都无所谓；如果是作为 uboot 项目维护者，则需要完整记录好详细的信息，以便更好的发展维护。</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>MX6ULL_LANJUT BOARD</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>M:\tArachnid &lt;xxxx@qq.com></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>S:\tMaintained</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>F:\tboard/freescale/mx6ull_lanjut/</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>F:\tinclude/configs/mx6ull_lanjut.h</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>F:\tconfigs/mx6ull_14x14_lanjut_defconfig</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>F:\tconfigs/mx6ull_14x14_lanjut_plugin_defconfig</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>F:\tconfigs/mx6ulz_14x14_lanjut_defconfig</pre></td></tr></table></figure><p>5、 <code>mx6ull_lanjut.c</code>  文件：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">vim</span> board/freescale/mx6ull_lanjut/mx6ull_lanjut.c</pre></td></tr></table></figure><ul>\n<li>\n<p><code>board_late_init</code>  函数</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">board_late_init</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">CONFIG_CMD_BMODE</span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t<span class=\"token function\">add_board_boot_modes</span><span class=\"token punctuation\">(</span>board_boot_modes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t<span class=\"token function\">env_set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"tee\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"no\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">CONFIG_IMX_OPTEE</span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t<span class=\"token function\">env_set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"tee\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"yes\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">CONFIG_ENV_VARS_UBOOT_RUNTIME_CONFIG</span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t<span class=\"token function\">env_set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"board_name\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"LANJUT\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t<span class=\"token comment\">// 决定了后面 findfdt 和 findtee 环境变量的选择</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">is_mx6ull_9x9_evk</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t\t<span class=\"token function\">env_set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"board_rev\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"9X9\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t<span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t\t<span class=\"token function\">env_set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"board_rev\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"14X14\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">is_cpu_type</span><span class=\"token punctuation\">(</span>MXC_CPU_MX6ULZ<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\t\t<span class=\"token function\">env_set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"board_name\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"ULZ-EVK\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>\t\t<span class=\"token function\">env_set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"usb_net_cmd\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"usb start\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>\t<span class=\"token function\">setup_lcd</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">CONFIG_ENV_IS_IN_MMC</span></span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>\t<span class=\"token function\">board_late_mmc_env_init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>\t<span class=\"token function\">set_wdog_reset</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">struct</span> <span class=\"token class-name\">wdog_regs</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>WDOG1_BASE_ADDR<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure></li>\n<li>\n<p><code>checkboard</code>  函数</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">checkboard</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">is_mx6ull_9x9_evk</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t\t<span class=\"token function\">puts</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Board: MX6ULL 9x9 EVK\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t<span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">is_cpu_type</span><span class=\"token punctuation\">(</span>MXC_CPU_MX6ULZ<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t\t<span class=\"token function\">puts</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Board: MX6ULZ 14x14 EVK\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t<span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t\t<span class=\"token function\">puts</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Board: MX6ULL 14x14 LANJUT\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t<span class=\"token comment\">//uboot 板载信息显示</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure></li>\n</ul>\n<h2 id=\"设备树文件\"><a class=\"anchor\" href=\"#设备树文件\">#</a> 设备树文件</h2>\n<p>在新版本 uboot 中，参考 Linux 内核引入了<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZGV2aWNldHJlZS5vcmcv\">设备树</span>和<span class=\"exturl\" data-url=\"aHR0cHM6Ly91LWJvb3QucmVhZHRoZWRvY3MuaW8vZW4vbGF0ZXN0L2RldmVsb3AvZHJpdmVyLW1vZGVsL2luZGV4Lmh0bWw=\">驱动模型 (Driver Model)</span>。</p>\n<p>1、 <code>imx6ull-14x14-lanjut-emmc.dts</code>  文件：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">ls</span> arch/arm/dts/*6ull*.dts</pre></td></tr><tr><td data-num=\"2\"></td><td data-command></td><td><pre>arch/arm/dts/imx6ull-14x14-ddr3-val.dts</pre></td></tr><tr><td data-num=\"3\"></td><td data-command></td><td><pre>arch/arm/dts/imx6ull-14x14-ddr3-val-emmc.dts</pre></td></tr><tr><td data-num=\"4\"></td><td data-command></td><td><pre>arch/arm/dts/imx6ull-14x14-ddr3-val-epdc.dts</pre></td></tr><tr><td data-num=\"5\"></td><td data-command></td><td><pre>arch/arm/dts/imx6ull-14x14-ddr3-val-gpmi-weim.dts</pre></td></tr><tr><td data-num=\"6\"></td><td data-command></td><td><pre>arch/arm/dts/imx6ull-14x14-ddr3-val-lcdif.dts</pre></td></tr><tr><td data-num=\"7\"></td><td data-command></td><td><pre>arch/arm/dts/imx6ull-14x14-ddr3-val-tsc.dts</pre></td></tr><tr><td data-num=\"8\"></td><td data-command></td><td><pre>arch/arm/dts/imx6ull-14x14-evk.dts</pre></td></tr><tr><td data-num=\"9\"></td><td data-command></td><td><pre>arch/arm/dts/imx6ull-14x14-evk-emmc.dts</pre></td></tr><tr><td data-num=\"10\"></td><td data-command></td><td><pre>arch/arm/dts/imx6ull-14x14-evk-gpmi-weim.dts</pre></td></tr><tr><td data-num=\"11\"></td><td data-command></td><td><pre>arch/arm/dts/imx6ull-9x9-evk.dts</pre></td></tr><tr><td data-num=\"12\"></td><td data-command></td><td><pre>arch/arm/dts/imx6ull-colibri.dts</pre></td></tr><tr><td data-num=\"13\"></td><td data-command></td><td><pre>arch/arm/dts/imx6ull-dart-6ul.dts</pre></td></tr><tr><td data-num=\"14\"></td><td data-command></td><td><pre>arch/arm/dts/imx6ull-phytec-segin-ff-rdk-emmc.dts</pre></td></tr><tr><td data-num=\"15\"></td><td data-command></td><td><pre>arch/arm/dts/imx6ull-somlabs-visionsom.dts</pre></td></tr><tr><td data-num=\"16\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">cp</span> arch/arm/dts/imx6ull-14x14-evk-emmc.dts arch/arm/dts/imx6ull-14x14-lanjut-emmc.dts</pre></td></tr><tr><td data-num=\"17\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">vim</span> arch/arm/dts/imx6ull-14x14-lanjut-emmc.dts</pre></td></tr></table></figure><p><strong>修改：</strong></p>\n<p>把  <code>#include &quot;imx6ull-14x14-evk.dts&quot;</code>  更改为  <code>#include &quot;imx6ull-14x14-lanjut.dts&quot;</code>  。</p>\n<p>2、 <code>imx6ull-14x14-lanjut.dts</code>  文件：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">cp</span> arch/arm/dts/imx6ull-14x14-evk.dts arch/arm/dts/imx6ull-14x14-lanjut.dts</pre></td></tr><tr><td data-num=\"2\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">vim</span> arch/arm/dts/imx6ull-14x14-lanjut.dts</pre></td></tr></table></figure><p><strong>修改：</strong></p>\n<p>把  <code>#include &quot;imx6ul-14x14-evk.dtsi&quot;</code>  更改为  <code>#include &quot;imx6ul-14x14-lanjut.dtsi&quot;</code>  ；</p>\n<p>把  <code>#include &quot;imx6ul-14x14-evk-u-boot.dtsi&quot;</code>  更改为  <code>#include &quot;imx6ul-14x14-lanjut-u-boot.dtsi&quot;</code>  。</p>\n<p>同时更改以下内容：</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/ &#123;</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\tmodel = \"i.MX6 ULL 14x14 EVK Board\";</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\tcompatible = \"fsl,imx6ull-14x14-evk\", \"fsl,imx6ull\";</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>&#125;;</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>改为</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>/ &#123;</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\tmodel = \"i.MX6 ULL 14x14 LANJUT Board\";</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\tcompatible = \"fsl,imx6ull-14x14-lanjut\", \"fsl,imx6ull\";</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>&#125;;</pre></td></tr></table></figure><p>3、 <code>imx6ul-14x14-lanjut.dtsi</code>  和  <code>imx6ul-14x14-lanjut-u-boot.dtsi</code>  文件：</p>\n<p>根据  <code>imx6ull-14x14-lanjut.dts</code>  文件的  <code>#include</code>  包含文件，分别添加文件。</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">cp</span> arch/arm/dts/imx6ul-14x14-evk.dtsi arch/arm/dts/imx6ul-14x14-lanjut.dtsi</pre></td></tr><tr><td data-num=\"2\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">cp</span> arch/arm/dts/imx6ul-14x14-evk-u-boot.dtsi arch/arm/dts/imx6ul-14x14-lanjut-u-boot.dtsi</pre></td></tr></table></figure><h2 id=\"配置文件\"><a class=\"anchor\" href=\"#配置文件\">#</a> 配置文件</h2>\n<p>1、 <code>mx6ull_14x14_lanjut_emmc_defconfig</code>  文件：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">ls</span> configs/*6ull*</pre></td></tr><tr><td data-num=\"2\"></td><td data-command></td><td><pre>configs/colibri-imx6ull_defconfig</pre></td></tr><tr><td data-num=\"3\"></td><td data-command></td><td><pre>configs/mx6ull_14x14_ddr3_val_defconfig</pre></td></tr><tr><td data-num=\"4\"></td><td data-command></td><td><pre>configs/mx6ull_14x14_ddr3_val_emmc_defconfig</pre></td></tr><tr><td data-num=\"5\"></td><td data-command></td><td><pre>configs/mx6ull_14x14_ddr3_val_epdc_defconfig</pre></td></tr><tr><td data-num=\"6\"></td><td data-command></td><td><pre>configs/mx6ull_14x14_ddr3_val_nand_defconfig</pre></td></tr><tr><td data-num=\"7\"></td><td data-command></td><td><pre>configs/mx6ull_14x14_ddr3_val_plugin_defconfig</pre></td></tr><tr><td data-num=\"8\"></td><td data-command></td><td><pre>configs/mx6ull_14x14_ddr3_val_qspi1_defconfig</pre></td></tr><tr><td data-num=\"9\"></td><td data-command></td><td><pre>configs/mx6ull_14x14_ddr3_val_spinor_defconfig</pre></td></tr><tr><td data-num=\"10\"></td><td data-command></td><td><pre>configs/mx6ull_14x14_ddr3_val_tsc_defconfig</pre></td></tr><tr><td data-num=\"11\"></td><td data-command></td><td><pre>configs/mx6ull_14x14_evk_defconfig</pre></td></tr><tr><td data-num=\"12\"></td><td data-command></td><td><pre>configs/mx6ull_14x14_evk_emmc_defconfig</pre></td></tr><tr><td data-num=\"13\"></td><td data-command></td><td><pre>configs/mx6ull_14x14_evk_nand_defconfig</pre></td></tr><tr><td data-num=\"14\"></td><td data-command></td><td><pre>configs/mx6ull_14x14_evk_optee_defconfig</pre></td></tr><tr><td data-num=\"15\"></td><td data-command></td><td><pre>configs/mx6ull_14x14_evk_plugin_defconfig</pre></td></tr><tr><td data-num=\"16\"></td><td data-command></td><td><pre>configs/mx6ull_14x14_evk_qspi1_defconfig</pre></td></tr><tr><td data-num=\"17\"></td><td data-command></td><td><pre>configs/mx6ull_9x9_evk_defconfig</pre></td></tr><tr><td data-num=\"18\"></td><td data-command></td><td><pre>configs/mx6ull_9x9_evk_plugin_defconfig</pre></td></tr><tr><td data-num=\"19\"></td><td data-command></td><td><pre>configs/mx6ull_9x9_evk_qspi1_defconfig</pre></td></tr><tr><td data-num=\"20\"></td><td data-command></td><td><pre>configs/somlabs_visionsom_6ull_defconfig</pre></td></tr><tr><td data-num=\"21\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">cp</span> configs/mx6ull_14x14_evk_emmc_defconfig configs/mx6ull_14x14_lanjut_emmc_defconfig</pre></td></tr><tr><td data-num=\"22\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">vim</span> configs/mx6ull_14x14_lanjut_emmc_defconfig</pre></td></tr></table></figure><p><strong>修改：</strong></p>\n<p>把  <code>CONFIG_TARGET_MX6ULL_14X14_EVK=y</code>  改为  <code>CONFIG_TARGET_MX6ULL_14X14_LANJUT=y</code>  ；</p>\n<p>把  <code>CONFIG_SYS_EXTRA_OPTIONS=&quot;IMX_CONFIG=board/freescale/mx6ullevk/imximage.cfg&quot;</code>  改为  <code>CONFIG_SYS_EXTRA_OPTIONS=&quot;IMX_CONFIG=board/freescale/mx6ull_lanjut/imximage.cfg&quot;</code>  ；</p>\n<p>把  <code>CONFIG_DEFAULT_DEVICE_TREE=&quot;imx6ull-14x14-evk-emmc&quot;</code>  改为  <code>CONFIG_DEFAULT_DEVICE_TREE=&quot;imx6ull-14x14-lanjut-emmc&quot;</code>  。</p>\n<p>2、 <code>include/configs/mx6ull_lanjut.h</code>  文件：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">ls</span> include/configs/*6ull*</pre></td></tr><tr><td data-num=\"2\"></td><td data-command></td><td><pre>include/configs/colibri-imx6ull.h  include/configs/mx6ullevk.h</pre></td></tr><tr><td data-num=\"3\"></td><td data-command></td><td><pre>include/configs/mx6ull_ddr3_val.h  include/configs/somlabs_visionsom_6ull.h</pre></td></tr><tr><td data-num=\"4\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">cp</span> include/configs/mx6ullevk.h include/configs/mx6ull_lanjut.h</pre></td></tr><tr><td data-num=\"5\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">vim</span> include/configs/mx6ull_lanjut.h</pre></td></tr></table></figure><p><strong>修改：</strong></p>\n<p>把  <code>#ifndef __MX6ULLEVK_CONFIG_H</code>  和  <code>#define __MX6ULLEVK_CONFIG_H</code>  改为  <code>#ifndef __MX6ULL_LANJUT_CONFIG_H</code>  和  <code>#define __MX6ULL_LANJUT_CONFIG_H</code>  。</p>\n<p>更改 uboot 默认命令配置值：</p>\n<ul>\n<li>\n<p>findfdt（用于设置  <code>fdt_file</code>  变量，根据  <code>board_name</code>  来指定<strong>传递给内核的设备树</strong>文件名）</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>\"findfdt=\"\\</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t\t\t\"if test $fdt_file = undefined; then \" \\</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t\t\t\t\"if test $board_name = ULZ-EVK &amp;&amp; test $board_rev = 14X14; then \" \\</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t\t\t\t\t\"setenv fdt_file imx6ulz-14x14-evk.dtb; fi; \" \\</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t\t\t\t\"if test $board_name = EVK &amp;&amp; test $board_rev = 9X9; then \" \\</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t\t\t\t\t\"setenv fdt_file imx6ull-9x9-evk.dtb; fi; \" \\</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t\t\t\t\"if test $board_name = EVK &amp;&amp; test $board_rev = 14X14; then \" \\</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t\t\t\t\t\"setenv fdt_file imx6ull-14x14-evk.dtb; fi; \" \\</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t\t\t\t\"if test $board_name = LANJUT &amp;&amp; test $board_rev = 14X14; then \" \\</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t\t\t\t\t\"setenv fdt_file imx6ull-14x14-lanjut.dtb; fi; \" \\</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t\t\t\t\"if test $fdt_file = undefined; then \" \\</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t\t\t\t\t\"echo WARNING: Could not determine dtb to use; \" \\</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t\t\t\t\"fi; \" \\</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t\t\t\"fi;\\0\" \\</pre></td></tr></table></figure></li>\n<li>\n<p>findtee（用于设置  <code>tee_file</code>  变量，根据  <code>board_name</code>  来指定 uboot 设备树文件名）</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>\"findtee=\"\\</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t\t\t\"if test $tee_file = undefined; then \" \\</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t\t\t\t\"if test $board_name = ULZ-EVK &amp;&amp; test $board_rev = 14X14; then \" \\</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t\t\t\t\t\"setenv tee_file uTee-6ulzevk; fi; \" \\</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t\t\t\t\"if test $board_name = EVK &amp;&amp; test $board_rev = 9X9; then \" \\</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t\t\t\t\t\"setenv tee_file uTee-6ullevk; fi; \" \\</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t\t\t\t\"if test $board_name = EVK &amp;&amp; test $board_rev = 14X14; then \" \\</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t\t\t\t\t\"setenv tee_file uTee-6ullevk; fi; \" \\</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t\t\t\t\"if test $board_name = LANJUT &amp;&amp; test $board_rev = 14X14; then \" \\</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t\t\t\t\t\"setenv tee_file uTee-6ull_lanjut; fi; \" \\</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t\t\t\t\"if test $tee_file = undefined; then \" \\</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t\t\t\t\t\"echo WARNING: Could not determine tee to use; \" \\</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t\t\t\t\"fi; \" \\</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t\t\t\"fi;\\0\" \\</pre></td></tr></table></figure></li>\n</ul>\n<h2 id=\"其它文件\"><a class=\"anchor\" href=\"#其它文件\">#</a> 其它文件</h2>\n<p>1、 <code>Makefile</code>  文件：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">vim</span> arch/arm/dts/Makefile</pre></td></tr></table></figure><p><strong>修改：</strong></p>\n<figure class=\"highlight makefile\"><figcaption data-lang=\"makefile\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>dtb-<span class=\"token variable\">$</span><span class=\"token punctuation\">(</span>CONFIG_MX6ULL<span class=\"token punctuation\">)</span> <span class=\"token operator\">+=</span> \\</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\timx6ull-14x14-ddr3-val.dtb \\</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\timx6ull-14x14-ddr3-val-epdc.dtb \\</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\timx6ull-14x14-ddr3-val-emmc.dtb \\</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\timx6ull-14x14-ddr3-val-gpmi-weim.dtb \\</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\timx6ull-14x14-ddr3-val-tsc.dtb \\</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\timx6ull-14x14-evk.dtb \\</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\timx6ull-14x14-evk-emmc.dtb \\</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\timx6ull-14x14-evk-gpmi-weim.dtb \\</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\timx6ull-14x14-lanjut-emmc.dtb \\  <span class=\"token comment\"># 将设备树文件添加进编译项</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\timx6ull-9x9-evk.dtb \\</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\timx6ull-colibri.dtb \\</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\timx6ull-phytec-segin-ff-rdk-emmc.dtb \\</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\timx6ull-dart-6ul.dtb \\</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\timx6ull-somlabs-visionsom.dtb \\</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\timx6ulz-14x14-evk.dtb \\</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\timx6ulz-14x14-evk-emmc.dtb \\</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\timx6ulz-14x14-evk-gpmi-weim.dtb</pre></td></tr></table></figure><p>2、 <code>Kconfig</code>  文件：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">vim</span> arch/arm/mach-imx/mx6/Kconfig</pre></td></tr></table></figure><p><strong>修改：</strong></p>\n<p>在  <code>config TARGET_MX6ULL_14X14_EVK</code>  配置的下方添加：</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>config TARGET_MX6ULL_14X14_LANJUT</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\tbool \"Support mx6ull_14x14_lanjut\"</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\tselect BOARD_LATE_INIT</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\tselect DM</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\tselect DM_THERMAL</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\tselect MX6ULL</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\timply CMD_DM</pre></td></tr></table></figure><p>在  <code>source &quot;board/freescale/mx6ullevk/Kconfig&quot;</code>  配置的下方添加：</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>source \"board/freescale/mx6ull_lanjut/Kconfig\"</pre></td></tr></table></figure><h1 id=\"定制外设\"><a class=\"anchor\" href=\"#定制外设\">#</a> 定制外设</h1>\n<h2 id=\"移除-74lv595-芯片相关配置\"><a class=\"anchor\" href=\"#移除-74lv595-芯片相关配置\">#</a> 移除 74lv595 芯片相关配置</h2>\n<p>1、 <code>mx6ull_14x14_lanjut_emmc_defconfig</code>  文件：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">vim</span> configs/mx6ull_14x14_lanjut_emmc_defconfig</pre></td></tr></table></figure><p>由于开发板上不需要用到 74lv595 芯片，因此取消与其相关的配置：</p>\n<ul>\n<li>找到  <code>CONFIG_DM_74X164=y</code>  改为  <code># CONFIG_DM_74X164 is not used</code>  ，官网 EVK 开发板使用了一个 74LV594，这里没有使用所以屏蔽掉。</li>\n<li>找到  <code>CONFIG_SOFT_SPI=y</code>  改为  <code># CONFIG_SOFT_SPI is not used</code>  ，屏蔽掉软件模拟的 SPI，这是官方驱动 74LV594 用的，同样也是用不到。</li>\n</ul>\n<p>2、 <code>imx6ul-14x14-lanjut.dtsi</code>  文件：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">vim</span> arch/arm/dts/imx6ul-14x14-lanjut.dtsi</pre></td></tr></table></figure><p>在  <code>configs/mx6ull_14x14_lanjut_emmc_defconfig</code>  文件中，我们有屏蔽掉  <code>74LV594</code>  和  <code>软件模拟的 SPI</code>  的定义使用，因此在设备树操作这里同样把其相关的配置屏蔽掉，从它们的调用关系可以得到以下需要屏蔽：</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/ &#123;</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t// aliases &#123;</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t// \tspi5 = &amp;&#123;/spi4&#125;;</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t// &#125;;</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t// reg_can_3v3: regulator-can-3v3 &#123;</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t// \tcompatible = \"regulator-fixed\";</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t// \tregulator-name = \"can-3v3\";</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t// \tregulator-min-microvolt = &lt;3300000>;</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t// \tregulator-max-microvolt = &lt;3300000>;</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t// \tgpios = &lt;&amp;gpio_spi 3 GPIO_ACTIVE_LOW>;</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t// &#125;;</pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t// spi4 &#123;</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t// \tcompatible = \"spi-gpio\";</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t// \tpinctrl-names = \"default\";</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t// \tpinctrl-0 = &lt;&amp;pinctrl_spi4>;</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t// \tstatus = \"okay\";</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t// \tpinctrl-assert-gpios = &lt;&amp;gpio5 8 GPIO_ACTIVE_LOW>;</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t// \tgpio-sck = &lt;&amp;gpio5 11 0>;</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\t// \tgpio-mosi = &lt;&amp;gpio5 10 0>;</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>\t// \tcs-gpios = &lt;&amp;gpio5 7 0>;</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>\t// \tnum-chipselects = &lt;1>;</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>\t// \t#address-cells = &lt;1>;</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>\t// \t#size-cells = &lt;0>;</pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>\t// \tgpio_spi: gpio@0 &#123;</pre></td></tr><tr><td data-num=\"28\"></td><td><pre>\t// \t\tcompatible = \"fairchild,74hc595\";</pre></td></tr><tr><td data-num=\"29\"></td><td><pre>\t// \t\tgpio-controller;</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>\t// \t\t#gpio-cells = &lt;2>;</pre></td></tr><tr><td data-num=\"31\"></td><td><pre>\t// \t\treg = &lt;0>;</pre></td></tr><tr><td data-num=\"32\"></td><td><pre>\t// \t\tregisters-number = &lt;1>;</pre></td></tr><tr><td data-num=\"33\"></td><td><pre>\t// \t\tregisters-default = /bits/ 8 &lt;0x57>;</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>\t// \t\tspi-max-frequency = &lt;100000>;</pre></td></tr><tr><td data-num=\"35\"></td><td><pre>\t// \t&#125;;</pre></td></tr><tr><td data-num=\"36\"></td><td><pre>\t// &#125;;</pre></td></tr><tr><td data-num=\"37\"></td><td><pre>&#125;;</pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>&amp;can1 &#123;</pre></td></tr><tr><td data-num=\"40\"></td><td><pre>\tpinctrl-names = \"default\";</pre></td></tr><tr><td data-num=\"41\"></td><td><pre>\tpinctrl-0 = &lt;&amp;pinctrl_flexcan1>;</pre></td></tr><tr><td data-num=\"42\"></td><td><pre>\t// xceiver-supply = &lt;&amp;reg_can_3v3>;</pre></td></tr><tr><td data-num=\"43\"></td><td><pre>\tstatus = \"okay\";</pre></td></tr><tr><td data-num=\"44\"></td><td><pre>&#125;;</pre></td></tr><tr><td data-num=\"45\"></td><td><pre></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>&amp;can2 &#123;</pre></td></tr><tr><td data-num=\"47\"></td><td><pre>\tpinctrl-names = \"default\";</pre></td></tr><tr><td data-num=\"48\"></td><td><pre>\tpinctrl-0 = &lt;&amp;pinctrl_flexcan2>;</pre></td></tr><tr><td data-num=\"49\"></td><td><pre>\t// xceiver-supply = &lt;&amp;reg_can_3v3>;</pre></td></tr><tr><td data-num=\"50\"></td><td><pre>\tstatus = \"okay\";</pre></td></tr><tr><td data-num=\"51\"></td><td><pre>&#125;;</pre></td></tr><tr><td data-num=\"52\"></td><td><pre></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>&amp;iomuxc &#123;</pre></td></tr><tr><td data-num=\"54\"></td><td><pre>\tpinctrl-names = \"default\";</pre></td></tr><tr><td data-num=\"55\"></td><td><pre></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>\t// pinctrl_spi4: spi4grp &#123;</pre></td></tr><tr><td data-num=\"57\"></td><td><pre>\t// \tfsl,pins = &lt;</pre></td></tr><tr><td data-num=\"58\"></td><td><pre>\t// \t\tMX6UL_PAD_BOOT_MODE0__GPIO5_IO10\t0x70a1</pre></td></tr><tr><td data-num=\"59\"></td><td><pre>\t// \t\tMX6UL_PAD_BOOT_MODE1__GPIO5_IO11\t0x70a1</pre></td></tr><tr><td data-num=\"60\"></td><td><pre>\t// \t\tMX6UL_PAD_SNVS_TAMPER7__GPIO5_IO07\t0x70a1</pre></td></tr><tr><td data-num=\"61\"></td><td><pre>\t// \t\tMX6UL_PAD_SNVS_TAMPER8__GPIO5_IO08\t0x80000000</pre></td></tr><tr><td data-num=\"62\"></td><td><pre>\t// \t>;</pre></td></tr><tr><td data-num=\"63\"></td><td><pre>\t// &#125;;</pre></td></tr><tr><td data-num=\"64\"></td><td><pre>&#125;;</pre></td></tr></table></figure><h2 id=\"修改网络接口配置\"><a class=\"anchor\" href=\"#修改网络接口配置\">#</a> 修改网络接口配置</h2>\n<p>打开你的设备树文件  <code>arch/arm/dts/imx6ull-14x14-lanjut-emmc.dts</code>  ，可以看到相应的引用关系： <code>imx6ull-14x14-lanjut-emmc.dts</code>  -&gt;  <code>imx6ull-14x14-lanjut.dts</code>  -&gt;  <code>imx6ull.dtsi</code>  -&gt;  <code>imx6ul-14x14-lanjut.dtsi</code>  -&gt;  <code>imx6ul-14x14-lanjut-u-boot.dtsi</code>  。而一般来说，  <code>.dtsi</code>  是系列芯片的公共部分，如同 C 语言上的头文件一般，  <code>.dts</code>  则用于定义特定部分；同样的，对于已经在  <code>.dtsi</code>  定义过的节点，可以在  <code>.dts</code>  中重新定义并覆盖。</p>\n<p>在 imx6ull 中，共提供了两组 ETH 网络接口引脚，在这里只需要配置一组就好了，多了没必要；可能你也会觉得 uboot 阶段只是为了引导 kernel 启动，何必多此一举呢，毕竟真正执行的配置是在 kernel 中的属性配置，但你是否想过后期如果需要修改 kernel，那么在此操作前，你能进行的 kernel 更新就只有 OTG 烧录及 SD Card 更新，并且需要拨码，相对于网络更新，稍微复杂一点，而且像 SD Card 你也未必携带有；因此，既然在 uboot 中存在一个如此便捷的升级方式，为何不好好应用起来呢？</p>\n<p>前面讲了 imx6ull 提供了两组 ETH 网络接口引脚，因此，只要有引出 ETH 接口，那么它们必定成组配置，所以无论你是用  <code>eth0</code>  或是  <code>eth1</code>  或想两组都用，在官方 demo 中一般都存在着对应组的设备树节点，可能唯一区别是  <code>eth0</code>  或  <code>eth1</code>  对应哪一组、PHY 地址不一样及网络芯片复位引脚所关联 GPIO 之类的；而且，对于用户设计来讲，一般都是跟官方的设计大同小异，没必要大改动以至于重新适配调试整个设备树配置及驱动修改，对此在这里以  <code>eth1</code> 、PHY 地址为 0x01 为例：</p>\n<p><strong>1、查阅关联信息</strong></p>\n<p>翻看芯片参考手册，找到与网络相关的章节，可以看到官方主要命名为 ENET；接下来在设备树中，包括引用的设备树头文件  <code>.dtsi</code>  里面搜索  <code>enet</code>  ，能找到名为  <code>&amp;fecx</code>  的设备树节点，这些节点信息就是对网络接口的配置。</p>\n<p><strong>2、节点属性</strong></p>\n<p>网络设备树节点属性，在这里可以根据自己所使用的 uboot 版本日期，去 <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZGV2aWNldHJlZS5vcmcvc3BlY2lmaWNhdGlvbnM=\">https://www.devicetree.org/specifications</span> 里找附近时期的文档查看；还有一种方式是在  <code>doc/device-tree-bindings/net/</code>  路径下查找相关的信息；不过不管是以上哪种方式，大部分也只是给出参考，实际需根据设备树函数处理来分析具体参数效果。</p>\n<p><strong>3、功能配置修改</strong></p>\n<p>在简单了解相关的信息后，然后就可以开始操刀修改配置了。</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>...</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>&amp;fec1 &#123;</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\tpinctrl-names = \"default\";</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\tpinctrl-0 = &lt;&amp;pinctrl_enet1>;</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\tphy-mode = \"rmii\";</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\tphy-handle = &lt;&amp;ethphy0>;</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\tstatus = \"okay\";</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>&#125;;</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>&amp;fec2 &#123;</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\tpinctrl-names = \"default\";</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\tpinctrl-0 = &lt;&amp;pinctrl_enet2>;</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\tphy-mode = \"rmii\";</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\tphy-handle = &lt;&amp;ethphy1>;</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\tstatus = \"okay\";</pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\tmdio &#123;</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t\t#address-cells = &lt;1>;</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t\t#size-cells = &lt;0>;</pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>\t\tethphy0: ethernet-phy@2 &#123;</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>\t\t\treg = &lt;2>;</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>\t\t\tmicrel,led-mode = &lt;1>;</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>\t\t\tclocks = &lt;&amp;clks IMX6UL_CLK_ENET_REF>;</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>\t\t\tclock-names = \"rmii-ref\";</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>\t\t&#125;;</pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>\t\tethphy1: ethernet-phy@1 &#123;</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>\t\t\treg = &lt;1>;</pre></td></tr><tr><td data-num=\"31\"></td><td><pre>\t\t\tmicrel,led-mode = &lt;1>;</pre></td></tr><tr><td data-num=\"32\"></td><td><pre>\t\t\tclocks = &lt;&amp;clks IMX6UL_CLK_ENET2_REF>;</pre></td></tr><tr><td data-num=\"33\"></td><td><pre>\t\t\tclock-names = \"rmii-ref\";</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>\t\t&#125;;</pre></td></tr><tr><td data-num=\"35\"></td><td><pre>\t&#125;;</pre></td></tr><tr><td data-num=\"36\"></td><td><pre>&#125;;</pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>...</pre></td></tr></table></figure><p>以上是相关的原有功能配置，然后  <code>eth0</code>  对应  <code>&amp;fec1</code>  、  <code>eth1</code>  对应  <code>&amp;fec2</code>  ，在这里只应用  <code>eth1</code>  ，因此在  <code>&amp;fec1</code>  中把  <code>status</code>  参数改成  <code>disable</code>  以关闭该项功能；紧接着如果你的 PHY 芯片复位引脚是引接到芯片上控制而非复位按键上，那么你应该需要添加对 PHY 芯片复位的控制：</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>&amp;fec2 &#123;</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\tpinctrl-names = \"default\";</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\tpinctrl-0 = &lt;&amp;pinctrl_enet2>;</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\tphy-mode = \"rmii\";</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\tphy-handle = &lt;&amp;ethphy1>;</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\tphy-reset-gpios = &lt;&amp;gpio5 8 GPIO_ACTIVE_LOW>;</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\tphy-reset-duration = &lt;10>;</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\tphy-reset-post-delay = &lt;10>;</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\tstatus = \"okay\";</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t...</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>&#125;;</pre></td></tr></table></figure><p>在  <code>&amp;fec2</code>  节点中，加入  <code>phy-reset-gpios</code>  参数指定 PHY 的复位引脚且说明低电平复位， <code>phy-reset-duration</code>  指定复位的持续时间， <code>phy-reset-post-delay</code>  指定复位延迟时间。</p>\n<p>在官方设备树里面， <code>eth0</code>  的 PHY 地址配置为 2、  <code>eth</code>  的 PHY 地址配置为 1，如果需要修改 PHY 地址，则可以在  <code>mdio</code>  里的  <code>ethphyx</code>  中的  <code>reg</code>  属性里更改为硬件设计上的 PHY 地址，然后为了统一标准，把  <code>ethernet-phy@x</code>  中  <code>@x</code>  的  <code>x</code>  改为  <code>reg</code>  上的数值（当然，你也可以选择不改，这并不会影响什么功能，只是设备树作为一份适合人类阅读的文本文件，影响到的是后期的阅读分析），在这里因为设计地址跟官方一样， <code>eth1</code>  的 PHY 地址为 1，因此不需要修改：</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>&amp;fec2 &#123;</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t...</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\tmdio &#123;</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t\t#address-cells = &lt;1>;</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t\t#size-cells = &lt;0>;</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t\tethphy0: ethernet-phy@2 &#123;</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t\t\treg = &lt;2>;</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t\t\tmicrel,led-mode = &lt;1>;</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t\t\tclocks = &lt;&amp;clks IMX6UL_CLK_ENET_REF>;</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t\t\tclock-names = \"rmii-ref\";</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t\t&#125;;</pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t\tethphy1: ethernet-phy@1 &#123;\t// 标识 PHY 地址为 1</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t\t\treg = &lt;1>;\t// PHY 地址设置为 1</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t\t\tmicrel,led-mode = &lt;1>;</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t\t\tclocks = &lt;&amp;clks IMX6UL_CLK_ENET2_REF>;</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t\t\tclock-names = \"rmii-ref\";</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t\t&#125;;</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\t&#125;;</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>&#125;;</pre></td></tr></table></figure><p><strong>4、复位引脚配置</strong></p>\n<p>A、配置分析</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>...</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>&amp;iomuxc &#123;</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\tpinctrl-names = \"default\";</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t...</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\tpinctrl_enet1: enet1grp &#123;</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t\tfsl,pins = &lt;</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t\t\tMX6UL_PAD_ENET1_RX_EN__ENET1_RX_EN\t0x1b0b0</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t\t\tMX6UL_PAD_ENET1_RX_ER__ENET1_RX_ER\t0x1b0b0</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t\t\tMX6UL_PAD_ENET1_RX_DATA0__ENET1_RDATA00\t0x1b0b0</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t\t\tMX6UL_PAD_ENET1_RX_DATA1__ENET1_RDATA01\t0x1b0b0</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t\t\tMX6UL_PAD_ENET1_TX_EN__ENET1_TX_EN\t0x1b0b0</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t\t\tMX6UL_PAD_ENET1_TX_DATA0__ENET1_TDATA00\t0x1b0b0</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t\t\tMX6UL_PAD_ENET1_TX_DATA1__ENET1_TDATA01\t0x1b0b0</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t\t\tMX6UL_PAD_ENET1_TX_CLK__ENET1_REF_CLK1\t0x4001b031</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t\t>;</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t&#125;;</pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\tpinctrl_enet2: enet2grp &#123;</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>\t\tfsl,pins = &lt;</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>\t\t\tMX6UL_PAD_GPIO1_IO07__ENET2_MDC\t\t0x1b0b0</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>\t\t\tMX6UL_PAD_GPIO1_IO06__ENET2_MDIO\t0x1b0b0</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>\t\t\tMX6UL_PAD_ENET2_RX_EN__ENET2_RX_EN\t0x1b0b0</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>\t\t\tMX6UL_PAD_ENET2_RX_ER__ENET2_RX_ER\t0x1b0b0</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>\t\t\tMX6UL_PAD_ENET2_RX_DATA0__ENET2_RDATA00\t0x1b0b0</pre></td></tr><tr><td data-num=\"28\"></td><td><pre>\t\t\tMX6UL_PAD_ENET2_RX_DATA1__ENET2_RDATA01\t0x1b0b0</pre></td></tr><tr><td data-num=\"29\"></td><td><pre>\t\t\tMX6UL_PAD_ENET2_TX_EN__ENET2_TX_EN\t0x1b0b0</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>\t\t\tMX6UL_PAD_ENET2_TX_DATA0__ENET2_TDATA00\t0x1b0b0</pre></td></tr><tr><td data-num=\"31\"></td><td><pre>\t\t\tMX6UL_PAD_ENET2_TX_DATA1__ENET2_TDATA01\t0x1b0b0</pre></td></tr><tr><td data-num=\"32\"></td><td><pre>\t\t\tMX6UL_PAD_ENET2_TX_CLK__ENET2_REF_CLK2\t0x4001b031</pre></td></tr><tr><td data-num=\"33\"></td><td><pre>\t\t>;</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>\t&#125;;</pre></td></tr><tr><td data-num=\"35\"></td><td><pre>\t</pre></td></tr><tr><td data-num=\"36\"></td><td><pre>\t...</pre></td></tr><tr><td data-num=\"37\"></td><td><pre>&#125;;</pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>...</pre></td></tr></table></figure><p>在功能配置里为  <code>eth1</code>  的 PHY 芯片添加了复位引脚的操作，因此我们必须对其 IO 进行初始化配置；由于以下修改主要涉及到设备树的引脚配置，因此在修改前先了解一下该芯片设备树中引脚定义规则和解析：</p>\n<p>在手册上，一个引脚一般支持 n 个可选功能（Alternate 缩写为 ALT）， 通过 IOMUX Controller 的控制器进行选择，IOMUX Controller 由两个子模块组成：</p>\n<ul>\n<li>IOMUXC_REGISTERS 包括所有的 IOMUXC 寄存器。</li>\n<li>IOMUXC_LOGIC 包括所有的 IOMUXC 组合逻辑（IP 接口控制、地址解码器、可观察性互斥器）。</li>\n</ul>\n<p>而 IOMUXC_REGISTERS 主要通过两个寄存器进行引脚的配置（note：XXX 表示为某一个 PAD 的名称，eg：GPIO1_IO07）：</p>\n<ul>\n<li>\n<p>IOMUXC_SW_MUX_CTL_PAD_XXX：用于配置引脚 MUX 的输入功能，包括 UART，GPIO，CSI 等功能。</p>\n<p><img data-src=\"/6ull-uboot-transplant/image-20240728182215737.png\" alt=\"image-20240728182215737\"></p>\n</li>\n<li>\n<p>IOMUXC_SW_PAD_CTL_PAD__XXX：用于配置具体功能的特性，包括上拉 / 下拉，速度，等特性。</p>\n<p><img data-src=\"/6ull-uboot-transplant/image-20240728182843672.png\" alt=\"image-20240728182843672\"></p>\n</li>\n</ul>\n<p>在设备树上 imx6u 系列的引脚定义在  <code>arch/arm/dts/imx6ul-pinfunc.h</code>  ，6ull 在此基础上追加  <code>imx6ull-pinfunc.h</code>  和  <code>imx6ull-pinfunc-snvs.h</code>  定义的扩展性功能引脚，而对于 GPIO1_IO07 的定义涵盖以下几项：</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">MX6UL_PAD_GPIO1_IO07__ENET1_MDC</span>\t\t\t<span class=\"token expression\"><span class=\"token number\">0x0078</span> <span class=\"token number\">0x0304</span> <span class=\"token number\">0x0000</span> <span class=\"token number\">0</span> <span class=\"token number\">0</span></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">MX6UL_PAD_GPIO1_IO07__ENET2_MDC</span>\t\t\t<span class=\"token expression\"><span class=\"token number\">0x0078</span> <span class=\"token number\">0x0304</span> <span class=\"token number\">0x0000</span> <span class=\"token number\">1</span> <span class=\"token number\">0</span></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">MX6UL_PAD_GPIO1_IO07__USB_OTG_HOST_MODE</span>\t\t<span class=\"token expression\"><span class=\"token number\">0x0078</span> <span class=\"token number\">0x0304</span> <span class=\"token number\">0x0000</span> <span class=\"token number\">2</span> <span class=\"token number\">0</span></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">MX6UL_PAD_GPIO1_IO07__CSI_PIXCLK</span>\t\t<span class=\"token expression\"><span class=\"token number\">0x0078</span> <span class=\"token number\">0x0304</span> <span class=\"token number\">0x0528</span> <span class=\"token number\">3</span> <span class=\"token number\">0</span></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">MX6UL_PAD_GPIO1_IO07__USDHC2_CD_B</span>\t\t<span class=\"token expression\"><span class=\"token number\">0x0078</span> <span class=\"token number\">0x0304</span> <span class=\"token number\">0x0674</span> <span class=\"token number\">4</span> <span class=\"token number\">1</span></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">MX6UL_PAD_GPIO1_IO07__GPIO1_IO07</span>\t\t<span class=\"token expression\"><span class=\"token number\">0x0078</span> <span class=\"token number\">0x0304</span> <span class=\"token number\">0x0000</span> <span class=\"token number\">5</span> <span class=\"token number\">0</span></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">MX6UL_PAD_GPIO1_IO07__CCM_STOP</span>\t\t\t<span class=\"token expression\"><span class=\"token number\">0x0078</span> <span class=\"token number\">0x0304</span> <span class=\"token number\">0x0000</span> <span class=\"token number\">6</span> <span class=\"token number\">0</span></span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">MX6UL_PAD_GPIO1_IO07__UART1_DCE_RTS</span>\t\t<span class=\"token expression\"><span class=\"token number\">0x0078</span> <span class=\"token number\">0x0304</span> <span class=\"token number\">0x0620</span> <span class=\"token number\">8</span> <span class=\"token number\">1</span></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">MX6UL_PAD_GPIO1_IO07__UART1_DTE_CTS</span>\t\t<span class=\"token expression\"><span class=\"token number\">0x0078</span> <span class=\"token number\">0x0304</span> <span class=\"token number\">0x0000</span> <span class=\"token number\">8</span> <span class=\"token number\">0</span></span></span></pre></td></tr></table></figure><p>可以看到 MX6UL_PAD_GPIO1_IO07 是这个引脚的寄存器名称，后面 ENET1_MDC 部分则是对应这个引脚的可选功能（ALTn），然后所定义的参数有 4 个值，而这 4 个值可以在该头文件顶部看到说明：</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre> * The pin function ID is a tuple of</pre></td></tr><tr><td data-num=\"3\"></td><td><pre> * &lt;mux_reg conf_reg input_reg mux_mode input_val></pre></td></tr><tr><td data-num=\"4\"></td><td><pre> */</pre></td></tr></table></figure><p>因此，像  <code>MX6UL_PAD_GPIO1_IO07__ENET2_MDC</code>  这个宏，其定义数值分别表示：</p>\n<ul>\n<li>mux_reg：IOMUXC_SW_MUX_CTL_PAD_GPIO1_IO07 - 偏移地址 <strong>0x0078</strong></li>\n<li>conf_reg：IOMUXC_SW_PAD_CTL_PAD_GPIO1_IO07 - 偏移地址 <strong>0x0304</strong></li>\n<li>input_reg：无寄存器（若有一般为 xxx_SELECT_INPUT） - 偏移地址 <strong>0x0000</strong></li>\n<li>mux_reg：IOMUXC_SW_MUX_CTL_PAD_GPIO1_IO07[3:0] - <strong>1</strong>（配置成 ALT0 - ENET2_MDC）</li>\n<li>input_val：由 input_reg 决定是否存在，依据 mux_reg 选择复用 - <strong>0</strong>（无 input_reg，此处为 0）</li>\n</ul>\n<p>而对于在  <code>dts</code>  中的  <code>MX6UL_PAD_GPIO1_IO07__ENET2_MDC 0x1b0b0</code>  主要是对 conf_reg 的配置，即 IOMUXC_SW_PAD_CTL_PAD_GPIO1_IO07 的值为  <code>0x1b0b0</code>  。这些数据的处理可以在  <code>drivers/pinctrl/nxp/pinctrl-imx.c</code>  中查到。至此，得到这样的一个配置关系：</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">mux_reg_ofs</th>\n<th style=\"text-align:center\">conf_reg_ofs</th>\n<th style=\"text-align:center\">input_reg_ofs</th>\n<th style=\"text-align:center\">mux_mode</th>\n<th style=\"text-align:center\">input_val</th>\n<th style=\"text-align:center\">config_val</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">0x0078</td>\n<td style=\"text-align:center\">0x0304</td>\n<td style=\"text-align:center\">0x0000</td>\n<td style=\"text-align:center\">1</td>\n<td style=\"text-align:center\">0</td>\n<td style=\"text-align:center\">0x1b0b0</td>\n</tr>\n</tbody>\n</table>\n<p>B、追加配置</p>\n<p>在了解完如何配置后，然后来配置一个  <code>GPIO5_IO08</code>  引脚的复位操作，草鸡简单，在  <code>pinctrl_enet2</code>  节点上追加  <code>MX6UL_PAD_SNVS_TAMPER8__GPIO5_IO08</code>  引脚的配置：</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>...</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>&amp;iomuxc &#123;</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\tpinctrl-names = \"default\";</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t...</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\tpinctrl_enet2: enet2grp &#123;</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t\tfsl,pins = &lt;</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t\t\t...</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t\t\t</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t\t\tMX6UL_PAD_SNVS_TAMPER8__GPIO5_IO08\t0x898\t/* ENET2 NRST */</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t\t>;</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t&#125;;</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t...</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>&#125;;</pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>...</pre></td></tr></table></figure><h1 id=\"uboot-裁剪\"><a class=\"anchor\" href=\"#uboot-裁剪\">#</a> uboot 裁剪</h1>\n<p>不管是购买的板子还是自己设计的板子，基本都是参考半导体厂商的 demo 板，而半导体厂商会在他们自己的开发板上移植好 uboot、linux kernel 和 rootfs 等，最终制作好 BSP 包提供给用户。我们只需在官方提供的 BSP 包的基础上，修改适应于自己的板子的外设配置，也就是俗称的移植。</p>\n<p>一般对 uboot 的移植裁剪。只需要解决串口、NAND、EMMC 或 SD 卡、网络和 LCD 驱动，因为 uboot 的主要目的就是启动 Linux 内核，所以不需要考虑太多的外设驱动，剩下的交给 linux kernel 进行详细配置。</p>\n<p>如果以单片机思维来讲，Linux 的 uboot 类似于 bootloader ，因此，在 uboot 上不需要过多的配置，只需要确保能正常进入 linux kernel 即可，毕竟进入到 linux kernel 后将会重新根据 linux kernel 的配置再次初始化一遍。</p>\n<p>前面讲了，除非必要的外设，把其余的功能移除掉，这便是裁剪；因此像 IIC、SPI、USB 这些等都可以屏蔽掉（或者确认以存储介质启动把网络也禁掉都是可以的），以减少编译生成使得缩少文件大小。</p>\n<p>裁剪方式很简单：</p>\n<p>1、在  <code>configs/</code>  文件夹中，找到你的板子配置文件，eg：  <code>mx6ull_14x14_lanjut_emmc_defconfig</code>  对不需要的功能进行屏蔽操作：</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>CONFIG_ARM=y</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>CONFIG_ARCH_MX6=y</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>CONFIG_TARGET_MX6ULL_14X14_LANJUT=y</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>CONFIG_ENV_SIZE=0x2000</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>CONFIG_ENV_OFFSET=0xE0000</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>CONFIG_DM_GPIO=y</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>CONFIG_NR_DRAM_BANKS=1</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>CONFIG_SYS_EXTRA_OPTIONS=\"IMX_CONFIG=board/freescale/mx6ull_lanjut/imximage.cfg\"</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>CONFIG_BOOTDELAY=1</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># CONFIG_CONSOLE_MUX is not set</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>CONFIG_SYS_CONSOLE_IS_IN_ENV=y</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>CONFIG_SUPPORT_RAW_INITRD=y</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>CONFIG_BOUNCE_BUFFER=y</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>CONFIG_BOARD_EARLY_INIT_F=y</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>CONFIG_HUSH_PARSER=y</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>CONFIG_CMD_BOOTZ=y</pre></td></tr><tr><td data-num=\"17\"></td><td><pre># CONFIG_CMD_IMLS is not set</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>CONFIG_CMD_MEMTEST=y</pre></td></tr><tr><td data-num=\"19\"></td><td><pre># CONFIG_CMD_GPIO=y</pre></td></tr><tr><td data-num=\"20\"></td><td><pre># CONFIG_CMD_I2C=y</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>CONFIG_CMD_MMC=y</pre></td></tr><tr><td data-num=\"22\"></td><td><pre># CONFIG_CMD_SF=y</pre></td></tr><tr><td data-num=\"23\"></td><td><pre># CONFIG_CMD_USB=y</pre></td></tr><tr><td data-num=\"24\"></td><td><pre># CONFIG_CMD_DHCP=y</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>CONFIG_CMD_PING=y</pre></td></tr><tr><td data-num=\"26\"></td><td><pre># CONFIG_CMD_BMP=y</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>CONFIG_CMD_CACHE=y</pre></td></tr><tr><td data-num=\"28\"></td><td><pre>CONFIG_CMD_NET=y</pre></td></tr><tr><td data-num=\"29\"></td><td><pre># CONFIG_CMD_EXT2=y</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>CONFIG_CMD_EXT4=y</pre></td></tr><tr><td data-num=\"31\"></td><td><pre>CONFIG_CMD_EXT4_WRITE=y</pre></td></tr><tr><td data-num=\"32\"></td><td><pre>CONFIG_CMD_FAT=y</pre></td></tr><tr><td data-num=\"33\"></td><td><pre>CONFIG_CMD_FS_GENERIC=y</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>CONFIG_OF_CONTROL=y</pre></td></tr><tr><td data-num=\"35\"></td><td><pre>CONFIG_DEFAULT_DEVICE_TREE=\"imx6ull-14x14-lanjut-emmc\"</pre></td></tr><tr><td data-num=\"36\"></td><td><pre>CONFIG_ENV_IS_IN_MMC=y</pre></td></tr><tr><td data-num=\"37\"></td><td><pre>CONFIG_SYS_RELOC_GD_ENV_ADDR=y</pre></td></tr><tr><td data-num=\"38\"></td><td><pre>CONFIG_ENV_VARS_UBOOT_RUNTIME_CONFIG=y</pre></td></tr><tr><td data-num=\"39\"></td><td><pre>CONFIG_NET_RANDOM_ETHADDR=y</pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre># CONFIG_DM_74X164 is not used</pre></td></tr><tr><td data-num=\"42\"></td><td><pre># CONFIG_DM_I2C=y</pre></td></tr><tr><td data-num=\"43\"></td><td><pre>CONFIG_DM_MMC=y</pre></td></tr><tr><td data-num=\"44\"></td><td><pre>CONFIG_FSL_USDHC=y</pre></td></tr><tr><td data-num=\"45\"></td><td><pre>CONFIG_MTD=y</pre></td></tr><tr><td data-num=\"46\"></td><td><pre># CONFIG_DM_SPI_FLASH=y</pre></td></tr><tr><td data-num=\"47\"></td><td><pre># CONFIG_SF_DEFAULT_MODE=0</pre></td></tr><tr><td data-num=\"48\"></td><td><pre># CONFIG_SF_DEFAULT_SPEED=40000000</pre></td></tr><tr><td data-num=\"49\"></td><td><pre># CONFIG_SPI_FLASH_STMICRO=y</pre></td></tr><tr><td data-num=\"50\"></td><td><pre>CONFIG_PHYLIB=y</pre></td></tr><tr><td data-num=\"51\"></td><td><pre># CONFIG_PHY_MICREL=y</pre></td></tr><tr><td data-num=\"52\"></td><td><pre># CONFIG_PHY_MICREL_KSZ8XXX=y</pre></td></tr><tr><td data-num=\"53\"></td><td><pre>CONFIG_DM_ETH=y</pre></td></tr><tr><td data-num=\"54\"></td><td><pre>CONFIG_DM_ETH_PHY=y</pre></td></tr><tr><td data-num=\"55\"></td><td><pre>CONFIG_FEC_MXC=y</pre></td></tr><tr><td data-num=\"56\"></td><td><pre>CONFIG_MII=y</pre></td></tr><tr><td data-num=\"57\"></td><td><pre>CONFIG_PINCTRL=y</pre></td></tr><tr><td data-num=\"58\"></td><td><pre>CONFIG_PINCTRL_IMX6=y</pre></td></tr><tr><td data-num=\"59\"></td><td><pre>CONFIG_DM_REGULATOR=y</pre></td></tr><tr><td data-num=\"60\"></td><td><pre>CONFIG_DM_REGULATOR_FIXED=y</pre></td></tr><tr><td data-num=\"61\"></td><td><pre>CONFIG_DM_REGULATOR_GPIO=y</pre></td></tr><tr><td data-num=\"62\"></td><td><pre># CONFIG_SPI=y</pre></td></tr><tr><td data-num=\"63\"></td><td><pre># CONFIG_DM_SPI=y</pre></td></tr><tr><td data-num=\"64\"></td><td><pre># CONFIG_SOFT_SPI is not used</pre></td></tr><tr><td data-num=\"65\"></td><td><pre># CONFIG_FSL_QSPI=y</pre></td></tr><tr><td data-num=\"66\"></td><td><pre># CONFIG_USB=y</pre></td></tr><tr><td data-num=\"67\"></td><td><pre># CONFIG_DM_USB=y</pre></td></tr><tr><td data-num=\"68\"></td><td><pre># CONFIG_USB_STORAGE=y</pre></td></tr><tr><td data-num=\"69\"></td><td><pre># CONFIG_USB_HOST_ETHER=y</pre></td></tr><tr><td data-num=\"70\"></td><td><pre># CONFIG_USB_ETHER_ASIX=y</pre></td></tr><tr><td data-num=\"71\"></td><td><pre># CONFIG_DM_VIDEO=y</pre></td></tr><tr><td data-num=\"72\"></td><td><pre>CONFIG_SYS_WHITE_ON_BLACK=y</pre></td></tr><tr><td data-num=\"73\"></td><td><pre></pre></td></tr><tr><td data-num=\"74\"></td><td><pre># CONFIG_USB_GADGET=y</pre></td></tr><tr><td data-num=\"75\"></td><td><pre># CONFIG_USB_GADGET_DOWNLOAD=y</pre></td></tr><tr><td data-num=\"76\"></td><td><pre># CONFIG_USB_GADGET_MANUFACTURER=\"FSL\"</pre></td></tr><tr><td data-num=\"77\"></td><td><pre># CONFIG_USB_GADGET_VENDOR_NUM=0x0525</pre></td></tr><tr><td data-num=\"78\"></td><td><pre># CONFIG_USB_GADGET_PRODUCT_NUM=0xa4a5</pre></td></tr><tr><td data-num=\"79\"></td><td><pre># CONFIG_CI_UDC=y</pre></td></tr><tr><td data-num=\"80\"></td><td><pre></pre></td></tr><tr><td data-num=\"81\"></td><td><pre># CONFIG_CMD_FASTBOOT=y</pre></td></tr><tr><td data-num=\"82\"></td><td><pre># CONFIG_USB_FUNCTION_FASTBOOT=y</pre></td></tr><tr><td data-num=\"83\"></td><td><pre># CONFIG_FASTBOOT_UUU_SUPPORT=y</pre></td></tr><tr><td data-num=\"84\"></td><td><pre># CONFIG_FASTBOOT=y</pre></td></tr><tr><td data-num=\"85\"></td><td><pre># CONFIG_FASTBOOT_BUF_ADDR=0x83800000</pre></td></tr><tr><td data-num=\"86\"></td><td><pre># CONFIG_FASTBOOT_BUF_SIZE=0x40000000</pre></td></tr><tr><td data-num=\"87\"></td><td><pre># CONFIG_FASTBOOT_FLASH=y</pre></td></tr><tr><td data-num=\"88\"></td><td><pre># CONFIG_EFI_PARTITION=y</pre></td></tr></table></figure><p>以上操作主要是裁切不需要的命令行、USB 操作、IIC 功能、SPI 功能、video  功能；当然你也可以通过先  <code>make xxx_defconfig</code>  生成  <code>.config</code>  文件，然后进行  <code>make meunconfig</code>  进入图型交互界面，对不需要的配置进行移除，在这里修改的目的是为了通过执行  <code>make xxx_defconfig</code>  后生成的默认  <code>.config</code>  文件即为裁剪好的配置，而不需要再进行  <code>make meunconfig</code>  选择移除。</p>\n<p>2、修改单板配置文件，eg：  <code>include/configs/mx6ull_lanjut.h</code>  ；该文件主要是配置 uboot env 环境及启动初始化。</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/* SPDX-License-Identifier: GPL-2.0+ */</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">/*</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> * Copyright (C) 2016 Freescale Semiconductor, Inc.</pre></td></tr><tr><td data-num=\"4\"></td><td><pre> * Copyright 2017 NXP</pre></td></tr><tr><td data-num=\"5\"></td><td><pre> *</pre></td></tr><tr><td data-num=\"6\"></td><td><pre> * Configuration settings for the Freescale i.MX6UL 14x14 EVK board.</pre></td></tr><tr><td data-num=\"7\"></td><td><pre> */</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifndef</span> <span class=\"token expression\">__MX6ULL_LANJUT_CONFIG_H</span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">__MX6ULL_LANJUT_CONFIG_H</span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;asm/arch/imx-regs.h></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;linux/sizes.h></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"mx6_common.h\"</span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;asm/mach-imx/gpio.h></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"imx_env.h\"</span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name function\">is_mx6ull_9x9_evk</span><span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\t<span class=\"token function\">CONFIG_IS_ENABLED</span><span class=\"token punctuation\">(</span>TARGET_MX6ULL_9X9_EVK<span class=\"token punctuation\">)</span></span></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">CONFIG_TARGET_MX6ULL_9X9_EVK</span></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">PHYS_SDRAM_SIZE</span>\t\t<span class=\"token expression\">SZ_256M</span></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">BOOTARGS_CMA_SIZE</span>   <span class=\"token string\">\"cma=96M \"</span></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">else</span></span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">PHYS_SDRAM_SIZE</span>\t\t<span class=\"token expression\">SZ_512M</span></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">BOOTARGS_CMA_SIZE</span>   <span class=\"token string\">\"\"</span></span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token comment\">/* DCDC used on 14x14 EVK, no PMIC */</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">undef</span> <span class=\"token expression\">CONFIG_LDO_BYPASS_CHECK</span></span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token comment\">/* Size of malloc() pool */</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_SYS_MALLOC_LEN</span>\t\t<span class=\"token expression\"><span class=\"token punctuation\">(</span><span class=\"token number\">16</span> <span class=\"token operator\">*</span> SZ_1M<span class=\"token punctuation\">)</span></span></span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_MXC_UART</span></span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_MXC_UART_BASE</span>\t\t<span class=\"token expression\">UART1_BASE</span></span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token comment\">/* MMC Configs */</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">CONFIG_FSL_USDHC</span></span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_SYS_FSL_ESDHC_ADDR</span>\t<span class=\"token expression\">USDHC2_BASE_ADDR</span></span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token comment\">/* NAND pin conflicts with usdhc2 */</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">CONFIG_NAND_MXS</span></span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_SYS_FSL_USDHC_NUM</span>\t<span class=\"token expression\"><span class=\"token number\">1</span></span></span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">else</span></span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_SYS_FSL_USDHC_NUM</span>\t<span class=\"token expression\"><span class=\"token number\">2</span></span></span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre></pre></td></tr><tr><td data-num=\"48\"></td><td><pre><span class=\"token comment\">/* I2C configs */</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">CONFIG_CMD_I2C</span></span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_SYS_I2C_MXC</span></span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_SYS_I2C_MXC_I2C1</span>\t\t<span class=\"token comment\">/* enable I2C bus 1 */</span></span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_SYS_I2C_MXC_I2C2</span>\t\t<span class=\"token comment\">/* enable I2C bus 2 */</span></span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_SYS_I2C_SPEED</span>\t\t<span class=\"token expression\"><span class=\"token number\">100000</span></span></span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre></pre></td></tr><tr><td data-num=\"56\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_SYS_MMC_IMG_LOAD_PART</span>\t<span class=\"token expression\"><span class=\"token number\">1</span></span></span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre></pre></td></tr><tr><td data-num=\"58\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">CONFIG_NAND_BOOT</span></span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">MFG_NAND_PARTITION</span> <span class=\"token string\">\"mtdparts=gpmi-nand:64m(nandboot),16m(nandkernel),16m(nanddtb),16m(nandtee),-(nandrootfs)\"</span></span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">else</span></span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">MFG_NAND_PARTITION</span> <span class=\"token string\">\"\"</span></span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre></pre></td></tr><tr><td data-num=\"64\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_CMD_READ</span></span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_SERIAL_TAG</span></span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_FASTBOOT_USB_DEV</span> <span class=\"token expression\"><span class=\"token number\">0</span></span></span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre></pre></td></tr><tr><td data-num=\"68\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_MFG_ENV_SETTINGS</span> <span class=\"token punctuation\">\\</span></span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>\t<span class=\"token expression\">CONFIG_MFG_ENV_SETTINGS_DEFAULT </span><span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>\t<span class=\"token string\">\"initrd_addr=0x86800000\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>\t<span class=\"token string\">\"initrd_high=0xffffffff\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>\t<span class=\"token string\">\"emmc_dev=1\\0\"</span><span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>\t<span class=\"token string\">\"emmc_ack=1\\0\"</span><span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>\t<span class=\"token string\">\"sd_dev=1\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>\t<span class=\"token string\">\"mtdparts=\"</span> <span class=\"token expression\">MFG_NAND_PARTITION </span><span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>\t<span class=\"token string\">\"\\0\"</span><span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre></pre></td></tr><tr><td data-num=\"78\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">if</span> <span class=\"token expression\"><span class=\"token function\">defined</span><span class=\"token punctuation\">(</span>CONFIG_NAND_BOOT<span class=\"token punctuation\">)</span></span></span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_EXTRA_ENV_SETTINGS</span> <span class=\"token punctuation\">\\</span></span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>\t<span class=\"token expression\">CONFIG_MFG_ENV_SETTINGS </span><span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>\t<span class=\"token expression\">TEE_ENV </span><span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>\t<span class=\"token string\">\"splashimage=0x8c000000\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>\t<span class=\"token string\">\"fdt_addr=0x83000000\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>\t<span class=\"token string\">\"fdt_high=0xffffffff\\0\"</span>\t  <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>\t<span class=\"token string\">\"tee_addr=0x84000000\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>\t<span class=\"token string\">\"console=ttymxc0\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>\t<span class=\"token string\">\"bootargs=console=ttymxc0,115200 ubi.mtd=nandrootfs \"</span>  <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>\t\t<span class=\"token string\">\"root=ubi0:rootfs rootfstype=ubifs \"</span>\t\t     <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>\t\t<span class=\"token expression\">BOOTARGS_CMA_SIZE </span><span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>\t\t<span class=\"token expression\">MFG_NAND_PARTITION </span><span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>\t\t<span class=\"token string\">\"\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>\t<span class=\"token string\">\"bootcmd=nand read $&#123;loadaddr&#125; 0x4000000 0xc00000;\"</span><span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>\t\t<span class=\"token string\">\"nand read $&#123;fdt_addr&#125; 0x5000000 0x100000;\"</span><span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>\t\t<span class=\"token string\">\"if test $&#123;tee&#125; = yes; then \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>\t\t\t<span class=\"token string\">\"nand read $&#123;tee_addr&#125; 0x6000000 0x400000;\"</span><span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>\t\t\t<span class=\"token string\">\"bootm $&#123;tee_addr&#125; - $&#123;fdt_addr&#125;;\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>\t\t<span class=\"token string\">\"else \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>\t\t\t<span class=\"token string\">\"bootz $&#123;loadaddr&#125; - $&#123;fdt_addr&#125;;\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>\t\t<span class=\"token string\">\"fi\\0\"</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre></pre></td></tr><tr><td data-num=\"101\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">else</span></span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_EXTRA_ENV_SETTINGS</span> <span class=\"token punctuation\">\\</span></span></pre></td></tr><tr><td data-num=\"103\"></td><td><pre>\t<span class=\"token expression\">CONFIG_MFG_ENV_SETTINGS </span><span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>\t<span class=\"token expression\">TEE_ENV </span><span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre>\t<span class=\"token string\">\"script=boot.scr\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre>\t<span class=\"token string\">\"image=zImage\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre>\t<span class=\"token string\">\"console=ttymxc0\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>\t<span class=\"token string\">\"fdt_high=0xffffffff\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre>\t<span class=\"token string\">\"initrd_high=0xffffffff\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>\t<span class=\"token string\">\"fdt_file=undefined\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>\t<span class=\"token string\">\"fdt_addr=0x83000000\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>\t<span class=\"token string\">\"tee_addr=0x84000000\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>\t<span class=\"token string\">\"tee_file=undefined\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>\t<span class=\"token string\">\"boot_fdt=try\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre>\t<span class=\"token string\">\"ip_dyn=no\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre>\t<span class=\"token string\">\"splashimage=0x8c000000\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre>\t<span class=\"token string\">\"mmcdev=\"</span><span class=\"token expression\"><span class=\"token function\">__stringify</span><span class=\"token punctuation\">(</span>CONFIG_SYS_MMC_ENV_DEV<span class=\"token punctuation\">)</span></span><span class=\"token string\">\"\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre>\t<span class=\"token string\">\"mmcpart=\"</span> <span class=\"token expression\"><span class=\"token function\">__stringify</span><span class=\"token punctuation\">(</span>CONFIG_SYS_MMC_IMG_LOAD_PART<span class=\"token punctuation\">)</span> </span><span class=\"token string\">\"\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre>\t<span class=\"token string\">\"mmcroot=\"</span> <span class=\"token expression\">CONFIG_MMCROOT </span><span class=\"token string\">\" rootwait rw\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"120\"></td><td><pre>\t<span class=\"token string\">\"mmcautodetect=yes\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>\t<span class=\"token string\">\"mmcargs=setenv bootargs console=$&#123;console&#125;,$&#123;baudrate&#125; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre>\t\t<span class=\"token expression\">BOOTARGS_CMA_SIZE </span><span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"123\"></td><td><pre>\t\t<span class=\"token string\">\"root=$&#123;mmcroot&#125;\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"124\"></td><td><pre>\t<span class=\"token string\">\"loadbootscript=\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"125\"></td><td><pre>\t\t<span class=\"token string\">\"fatload mmc $&#123;mmcdev&#125;:$&#123;mmcpart&#125; $&#123;loadaddr&#125; $&#123;script&#125;;\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre>\t<span class=\"token string\">\"bootscript=echo Running bootscript from mmc ...; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"127\"></td><td><pre>\t\t<span class=\"token string\">\"source\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"128\"></td><td><pre>\t<span class=\"token string\">\"loadimage=fatload mmc $&#123;mmcdev&#125;:$&#123;mmcpart&#125; $&#123;loadaddr&#125; $&#123;image&#125;\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"129\"></td><td><pre>\t<span class=\"token string\">\"loadfdt=fatload mmc $&#123;mmcdev&#125;:$&#123;mmcpart&#125; $&#123;fdt_addr&#125; $&#123;fdt_file&#125;\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre>\t<span class=\"token string\">\"loadtee=fatload mmc $&#123;mmcdev&#125;:$&#123;mmcpart&#125; $&#123;tee_addr&#125; $&#123;tee_file&#125;\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"131\"></td><td><pre>\t<span class=\"token string\">\"mmcboot=echo Booting from mmc ...; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"132\"></td><td><pre>\t\t<span class=\"token string\">\"run mmcargs; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"133\"></td><td><pre>\t\t<span class=\"token string\">\"if test $&#123;tee&#125; = yes; then \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"134\"></td><td><pre>\t\t\t<span class=\"token string\">\"run loadfdt; run loadtee; bootm $&#123;tee_addr&#125; - $&#123;fdt_addr&#125;; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"135\"></td><td><pre>\t\t<span class=\"token string\">\"else \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"136\"></td><td><pre>\t\t\t<span class=\"token string\">\"if test $&#123;boot_fdt&#125; = yes || test $&#123;boot_fdt&#125; = try; then \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"137\"></td><td><pre>\t\t\t\t<span class=\"token string\">\"if run loadfdt; then \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"138\"></td><td><pre>\t\t\t\t\t<span class=\"token string\">\"bootz $&#123;loadaddr&#125; - $&#123;fdt_addr&#125;; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"139\"></td><td><pre>\t\t\t\t<span class=\"token string\">\"else \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"140\"></td><td><pre>\t\t\t\t\t<span class=\"token string\">\"if test $&#123;boot_fdt&#125; = try; then \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"141\"></td><td><pre>\t\t\t\t\t\t<span class=\"token string\">\"bootz; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"142\"></td><td><pre>\t\t\t\t\t<span class=\"token string\">\"else \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"143\"></td><td><pre>\t\t\t\t\t\t<span class=\"token string\">\"echo WARN: Cannot load the DT; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"144\"></td><td><pre>\t\t\t\t\t<span class=\"token string\">\"fi; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"145\"></td><td><pre>\t\t\t\t<span class=\"token string\">\"fi; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"146\"></td><td><pre>\t\t\t<span class=\"token string\">\"else \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"147\"></td><td><pre>\t\t\t\t<span class=\"token string\">\"bootz; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"148\"></td><td><pre>\t\t\t<span class=\"token string\">\"fi; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"149\"></td><td><pre>\t\t<span class=\"token string\">\"fi;\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"150\"></td><td><pre>\t<span class=\"token string\">\"netargs=setenv bootargs console=$&#123;console&#125;,$&#123;baudrate&#125; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"151\"></td><td><pre>\t\t<span class=\"token expression\">BOOTARGS_CMA_SIZE </span><span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"152\"></td><td><pre>\t\t<span class=\"token string\">\"root=/dev/nfs \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"153\"></td><td><pre>\t\t<span class=\"token string\">\"ip=dhcp nfsroot=$&#123;serverip&#125;:$&#123;nfsroot&#125;,v3,tcp\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"154\"></td><td><pre>\t<span class=\"token string\">\"netboot=echo Booting from net ...; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"155\"></td><td><pre>\t\t<span class=\"token string\">\"$&#123;usb_net_cmd&#125;; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"156\"></td><td><pre>\t\t<span class=\"token string\">\"run netargs; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"157\"></td><td><pre>\t\t<span class=\"token string\">\"if test $&#123;ip_dyn&#125; = yes; then \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"158\"></td><td><pre>\t\t\t<span class=\"token string\">\"setenv get_cmd dhcp; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"159\"></td><td><pre>\t\t<span class=\"token string\">\"else \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"160\"></td><td><pre>\t\t\t<span class=\"token string\">\"setenv get_cmd tftp; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"161\"></td><td><pre>\t\t<span class=\"token string\">\"fi; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"162\"></td><td><pre>\t\t<span class=\"token string\">\"$&#123;get_cmd&#125; $&#123;image&#125;; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"163\"></td><td><pre>\t\t<span class=\"token string\">\"if test $&#123;tee&#125; = yes; then \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"164\"></td><td><pre>\t\t\t<span class=\"token string\">\"$&#123;get_cmd&#125; $&#123;tee_addr&#125; $&#123;tee_file&#125;; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"165\"></td><td><pre>\t\t\t<span class=\"token string\">\"$&#123;get_cmd&#125; $&#123;fdt_addr&#125; $&#123;fdt_file&#125;; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"166\"></td><td><pre>\t\t\t<span class=\"token string\">\"bootm $&#123;tee_addr&#125; - $&#123;fdt_addr&#125;; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"167\"></td><td><pre>\t\t<span class=\"token string\">\"else \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"168\"></td><td><pre>\t\t\t<span class=\"token string\">\"if test $&#123;boot_fdt&#125; = yes || test $&#123;boot_fdt&#125; = try; then \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"169\"></td><td><pre>\t\t\t\t<span class=\"token string\">\"if $&#123;get_cmd&#125; $&#123;fdt_addr&#125; $&#123;fdt_file&#125;; then \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"170\"></td><td><pre>\t\t\t\t\t<span class=\"token string\">\"bootz $&#123;loadaddr&#125; - $&#123;fdt_addr&#125;; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"171\"></td><td><pre>\t\t\t\t<span class=\"token string\">\"else \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"172\"></td><td><pre>\t\t\t\t\t<span class=\"token string\">\"if test $&#123;boot_fdt&#125; = try; then \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"173\"></td><td><pre>\t\t\t\t\t\t<span class=\"token string\">\"bootz; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"174\"></td><td><pre>\t\t\t\t\t<span class=\"token string\">\"else \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"175\"></td><td><pre>\t\t\t\t\t\t<span class=\"token string\">\"echo WARN: Cannot load the DT; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"176\"></td><td><pre>\t\t\t\t\t<span class=\"token string\">\"fi; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"177\"></td><td><pre>\t\t\t\t<span class=\"token string\">\"fi; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"178\"></td><td><pre>\t\t\t<span class=\"token string\">\"else \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"179\"></td><td><pre>\t\t\t\t<span class=\"token string\">\"bootz; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"180\"></td><td><pre>\t\t\t<span class=\"token string\">\"fi; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"181\"></td><td><pre>\t\t<span class=\"token string\">\"fi;\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"182\"></td><td><pre>\t\t<span class=\"token string\">\"findfdt=\"</span><span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"183\"></td><td><pre>\t\t\t<span class=\"token string\">\"if test $fdt_file = undefined; then \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"184\"></td><td><pre>\t\t\t\t<span class=\"token string\">\"if test $board_name = ULZ-EVK &amp;&amp; test $board_rev = 14X14; then \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"185\"></td><td><pre>\t\t\t\t\t<span class=\"token string\">\"setenv fdt_file imx6ulz-14x14-evk.dtb; fi; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"186\"></td><td><pre>\t\t\t\t<span class=\"token string\">\"if test $board_name = EVK &amp;&amp; test $board_rev = 9X9; then \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"187\"></td><td><pre>\t\t\t\t\t<span class=\"token string\">\"setenv fdt_file imx6ull-9x9-evk.dtb; fi; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"188\"></td><td><pre>\t\t\t\t<span class=\"token string\">\"if test $board_name = EVK &amp;&amp; test $board_rev = 14X14; then \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"189\"></td><td><pre>\t\t\t\t\t<span class=\"token string\">\"setenv fdt_file imx6ull-14x14-evk.dtb; fi; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"190\"></td><td><pre>\t\t\t\t<span class=\"token string\">\"if test $board_name = LANJUT &amp;&amp; test $board_rev = 14X14; then \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"191\"></td><td><pre>\t\t\t\t\t<span class=\"token string\">\"setenv fdt_file imx6ull-14x14-lanjut.dtb; fi; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"192\"></td><td><pre>\t\t\t\t<span class=\"token string\">\"if test $fdt_file = undefined; then \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"193\"></td><td><pre>\t\t\t\t\t<span class=\"token string\">\"echo WARNING: Could not determine dtb to use; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"194\"></td><td><pre>\t\t\t\t<span class=\"token string\">\"fi; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"195\"></td><td><pre>\t\t\t<span class=\"token string\">\"fi;\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"196\"></td><td><pre>\t\t<span class=\"token string\">\"findtee=\"</span><span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"197\"></td><td><pre>\t\t\t<span class=\"token string\">\"if test $tee_file = undefined; then \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"198\"></td><td><pre>\t\t\t\t<span class=\"token string\">\"if test $board_name = ULZ-EVK &amp;&amp; test $board_rev = 14X14; then \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"199\"></td><td><pre>\t\t\t\t\t<span class=\"token string\">\"setenv tee_file uTee-6ulzevk; fi; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"200\"></td><td><pre>\t\t\t\t<span class=\"token string\">\"if test $board_name = EVK &amp;&amp; test $board_rev = 9X9; then \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"201\"></td><td><pre>\t\t\t\t\t<span class=\"token string\">\"setenv tee_file uTee-6ullevk; fi; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"202\"></td><td><pre>\t\t\t\t<span class=\"token string\">\"if test $board_name = EVK &amp;&amp; test $board_rev = 14X14; then \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"203\"></td><td><pre>\t\t\t\t\t<span class=\"token string\">\"setenv tee_file uTee-6ullevk; fi; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"204\"></td><td><pre>\t\t\t\t<span class=\"token string\">\"if test $board_name = LANJUT &amp;&amp; test $board_rev = 14X14; then \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"205\"></td><td><pre>\t\t\t\t\t<span class=\"token string\">\"setenv tee_file uTee-6ull_lanjut; fi; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"206\"></td><td><pre>\t\t\t\t<span class=\"token string\">\"if test $tee_file = undefined; then \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"207\"></td><td><pre>\t\t\t\t\t<span class=\"token string\">\"echo WARNING: Could not determine tee to use; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"208\"></td><td><pre>\t\t\t\t<span class=\"token string\">\"fi; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"209\"></td><td><pre>\t\t\t<span class=\"token string\">\"fi;\\0\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"210\"></td><td><pre></pre></td></tr><tr><td data-num=\"211\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_BOOTCOMMAND</span> <span class=\"token punctuation\">\\</span></span></pre></td></tr><tr><td data-num=\"212\"></td><td><pre>\t   <span class=\"token string\">\"run findfdt;\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"213\"></td><td><pre>\t   <span class=\"token string\">\"run findtee;\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"214\"></td><td><pre>\t   <span class=\"token string\">\"mmc dev $&#123;mmcdev&#125;;\"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"215\"></td><td><pre>\t   <span class=\"token string\">\"mmc dev $&#123;mmcdev&#125;; if mmc rescan; then \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"216\"></td><td><pre>\t\t   <span class=\"token string\">\"if run loadbootscript; then \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"217\"></td><td><pre>\t\t\t   <span class=\"token string\">\"run bootscript; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"218\"></td><td><pre>\t\t   <span class=\"token string\">\"else \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"219\"></td><td><pre>\t\t\t   <span class=\"token string\">\"if run loadimage; then \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"220\"></td><td><pre>\t\t\t\t   <span class=\"token string\">\"run mmcboot; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"221\"></td><td><pre>\t\t\t   <span class=\"token string\">\"else run netboot; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"222\"></td><td><pre>\t\t\t   <span class=\"token string\">\"fi; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"223\"></td><td><pre>\t\t   <span class=\"token string\">\"fi; \"</span> <span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"224\"></td><td><pre>\t   <span class=\"token string\">\"else run netboot; fi\"</span></pre></td></tr><tr><td data-num=\"225\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr><tr><td data-num=\"226\"></td><td><pre></pre></td></tr><tr><td data-num=\"227\"></td><td><pre><span class=\"token comment\">/* Miscellaneous configurable options */</span></pre></td></tr><tr><td data-num=\"228\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_SYS_MEMTEST_START</span>\t<span class=\"token expression\"><span class=\"token number\">0x80000000</span></span></span></pre></td></tr><tr><td data-num=\"229\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_SYS_MEMTEST_END</span>\t\t<span class=\"token expression\"><span class=\"token punctuation\">(</span>CONFIG_SYS_MEMTEST_START <span class=\"token operator\">+</span> <span class=\"token number\">0x8000000</span><span class=\"token punctuation\">)</span></span></span></pre></td></tr><tr><td data-num=\"230\"></td><td><pre></pre></td></tr><tr><td data-num=\"231\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_SYS_LOAD_ADDR</span>\t\t<span class=\"token expression\">CONFIG_LOADADDR</span></span></pre></td></tr><tr><td data-num=\"232\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_SYS_HZ</span>\t\t\t<span class=\"token expression\"><span class=\"token number\">1000</span></span></span></pre></td></tr><tr><td data-num=\"233\"></td><td><pre></pre></td></tr><tr><td data-num=\"234\"></td><td><pre><span class=\"token comment\">/* Physical Memory Map */</span></pre></td></tr><tr><td data-num=\"235\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">PHYS_SDRAM</span>\t\t\t<span class=\"token expression\">MMDC0_ARB_BASE_ADDR</span></span></pre></td></tr><tr><td data-num=\"236\"></td><td><pre></pre></td></tr><tr><td data-num=\"237\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_SYS_SDRAM_BASE</span>\t\t<span class=\"token expression\">PHYS_SDRAM</span></span></pre></td></tr><tr><td data-num=\"238\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_SYS_INIT_RAM_ADDR</span>\t<span class=\"token expression\">IRAM_BASE_ADDR</span></span></pre></td></tr><tr><td data-num=\"239\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_SYS_INIT_RAM_SIZE</span>\t<span class=\"token expression\">IRAM_SIZE</span></span></pre></td></tr><tr><td data-num=\"240\"></td><td><pre></pre></td></tr><tr><td data-num=\"241\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_SYS_INIT_SP_OFFSET</span> <span class=\"token punctuation\">\\</span></span></pre></td></tr><tr><td data-num=\"242\"></td><td><pre>\t<span class=\"token expression\"><span class=\"token punctuation\">(</span>CONFIG_SYS_INIT_RAM_SIZE <span class=\"token operator\">-</span> GENERATED_GBL_DATA_SIZE<span class=\"token punctuation\">)</span></span></pre></td></tr><tr><td data-num=\"243\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_SYS_INIT_SP_ADDR</span> <span class=\"token punctuation\">\\</span></span></pre></td></tr><tr><td data-num=\"244\"></td><td><pre>\t<span class=\"token expression\"><span class=\"token punctuation\">(</span>CONFIG_SYS_INIT_RAM_ADDR <span class=\"token operator\">+</span> CONFIG_SYS_INIT_SP_OFFSET<span class=\"token punctuation\">)</span></span></pre></td></tr><tr><td data-num=\"245\"></td><td><pre></pre></td></tr><tr><td data-num=\"246\"></td><td><pre><span class=\"token comment\">/* environment organization */</span></pre></td></tr><tr><td data-num=\"247\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_SYS_MMC_ENV_DEV</span>\t\t<span class=\"token expression\"><span class=\"token number\">1</span>\t</span><span class=\"token comment\">/* USDHC2 */</span></span></pre></td></tr><tr><td data-num=\"248\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_SYS_MMC_ENV_PART</span>\t\t<span class=\"token expression\"><span class=\"token number\">0</span>\t</span><span class=\"token comment\">/* user area */</span></span></pre></td></tr><tr><td data-num=\"249\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_MMCROOT</span>\t\t\t<span class=\"token string\">\"/dev/mmcblk1p2\"</span>  <span class=\"token comment\">/* USDHC2 */</span></span></pre></td></tr><tr><td data-num=\"250\"></td><td><pre></pre></td></tr><tr><td data-num=\"251\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_IOMUX_LPSR</span></span></pre></td></tr><tr><td data-num=\"252\"></td><td><pre></pre></td></tr><tr><td data-num=\"253\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">CONFIG_FSL_QSPI</span></span></pre></td></tr><tr><td data-num=\"254\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_SYS_FSL_QSPI_AHB</span></span></pre></td></tr><tr><td data-num=\"255\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">FSL_QSPI_FLASH_NUM</span>\t\t<span class=\"token expression\"><span class=\"token number\">1</span></span></span></pre></td></tr><tr><td data-num=\"256\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">FSL_QSPI_FLASH_SIZE</span>\t\t<span class=\"token expression\">SZ_32M</span></span></pre></td></tr><tr><td data-num=\"257\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr><tr><td data-num=\"258\"></td><td><pre></pre></td></tr><tr><td data-num=\"259\"></td><td><pre><span class=\"token comment\">/* NAND stuff */</span></pre></td></tr><tr><td data-num=\"260\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">CONFIG_NAND_MXS</span></span></pre></td></tr><tr><td data-num=\"261\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_SYS_MAX_NAND_DEVICE</span>\t<span class=\"token expression\"><span class=\"token number\">1</span></span></span></pre></td></tr><tr><td data-num=\"262\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_SYS_NAND_BASE</span>\t\t<span class=\"token expression\"><span class=\"token number\">0x40000000</span></span></span></pre></td></tr><tr><td data-num=\"263\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_SYS_NAND_5_ADDR_CYCLE</span></span></pre></td></tr><tr><td data-num=\"264\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_SYS_NAND_ONFI_DETECTION</span></span></pre></td></tr><tr><td data-num=\"265\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_SYS_NAND_USE_FLASH_BBT</span></span></pre></td></tr><tr><td data-num=\"266\"></td><td><pre></pre></td></tr><tr><td data-num=\"267\"></td><td><pre><span class=\"token comment\">/* DMA stuff, needed for GPMI/MXS NAND support */</span></pre></td></tr><tr><td data-num=\"268\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr><tr><td data-num=\"269\"></td><td><pre></pre></td></tr><tr><td data-num=\"270\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">if</span> <span class=\"token expression\"><span class=\"token function\">defined</span><span class=\"token punctuation\">(</span>CONFIG_ENV_IS_IN_SPI_FLASH<span class=\"token punctuation\">)</span></span></span></pre></td></tr><tr><td data-num=\"271\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_ENV_SPI_BUS</span>\t\t<span class=\"token expression\">CONFIG_SF_DEFAULT_BUS</span></span></pre></td></tr><tr><td data-num=\"272\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_ENV_SPI_CS</span>\t\t<span class=\"token expression\">CONFIG_SF_DEFAULT_CS</span></span></pre></td></tr><tr><td data-num=\"273\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_ENV_SPI_MODE</span>\t\t<span class=\"token expression\">CONFIG_SF_DEFAULT_MODE</span></span></pre></td></tr><tr><td data-num=\"274\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_ENV_SPI_MAX_HZ</span>\t\t<span class=\"token expression\">CONFIG_SF_DEFAULT_SPEED</span></span></pre></td></tr><tr><td data-num=\"275\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr><tr><td data-num=\"276\"></td><td><pre></pre></td></tr><tr><td data-num=\"277\"></td><td><pre><span class=\"token comment\">/* USB Configs */</span></pre></td></tr><tr><td data-num=\"278\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">CONFIG_CMD_USB</span></span></pre></td></tr><tr><td data-num=\"279\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_EHCI_HCD_INIT_AFTER_RESET</span></span></pre></td></tr><tr><td data-num=\"280\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_MXC_USB_PORTSC</span>  <span class=\"token expression\"><span class=\"token punctuation\">(</span>PORT_PTS_UTMI <span class=\"token operator\">|</span> PORT_PTS_PTW<span class=\"token punctuation\">)</span></span></span></pre></td></tr><tr><td data-num=\"281\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_MXC_USB_FLAGS</span>   <span class=\"token expression\"><span class=\"token number\">0</span></span></span></pre></td></tr><tr><td data-num=\"282\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_USB_MAX_CONTROLLER_COUNT</span> <span class=\"token expression\"><span class=\"token number\">2</span></span></span></pre></td></tr><tr><td data-num=\"283\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr><tr><td data-num=\"284\"></td><td><pre></pre></td></tr><tr><td data-num=\"285\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_FEC_XCV_TYPE</span>             <span class=\"token expression\">RMII</span></span></pre></td></tr><tr><td data-num=\"286\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_ETHPRIME</span>\t\t\t<span class=\"token string\">\"eth1\"</span></span></pre></td></tr><tr><td data-num=\"287\"></td><td><pre></pre></td></tr><tr><td data-num=\"288\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_IMX_THERMAL</span></span></pre></td></tr><tr><td data-num=\"289\"></td><td><pre></pre></td></tr><tr><td data-num=\"290\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifndef</span> <span class=\"token expression\">CONFIG_SPL_BUILD</span></span></pre></td></tr><tr><td data-num=\"291\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">if</span> <span class=\"token expression\"><span class=\"token function\">defined</span><span class=\"token punctuation\">(</span>CONFIG_DM_VIDEO<span class=\"token punctuation\">)</span></span></span></pre></td></tr><tr><td data-num=\"292\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_VIDEO_MXS</span></span></pre></td></tr><tr><td data-num=\"293\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_VIDEO_LINK</span></span></pre></td></tr><tr><td data-num=\"294\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_VIDEO_LOGO</span></span></pre></td></tr><tr><td data-num=\"295\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_SPLASH_SCREEN</span></span></pre></td></tr><tr><td data-num=\"296\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_SPLASH_SCREEN_ALIGN</span></span></pre></td></tr><tr><td data-num=\"297\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_BMP_16BPP</span></span></pre></td></tr><tr><td data-num=\"298\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_VIDEO_BMP_RLE8</span></span></pre></td></tr><tr><td data-num=\"299\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_VIDEO_BMP_LOGO</span></span></pre></td></tr><tr><td data-num=\"300\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr><tr><td data-num=\"301\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr><tr><td data-num=\"302\"></td><td><pre></pre></td></tr><tr><td data-num=\"303\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_MODULE_FUSE</span></span></pre></td></tr><tr><td data-num=\"304\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_OF_SYSTEM_SETUP</span></span></pre></td></tr><tr><td data-num=\"305\"></td><td><pre></pre></td></tr><tr><td data-num=\"306\"></td><td><pre><span class=\"token comment\">/* Network Configs */</span></pre></td></tr><tr><td data-num=\"307\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_IPADDR</span>          <span class=\"token expression\"><span class=\"token number\">192.168</span><span class=\"token number\">.137</span><span class=\"token number\">.234</span>      </span><span class=\"token comment\">/* board ip */</span></span></pre></td></tr><tr><td data-num=\"308\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_SERVERIP</span>     <span class=\"token expression\"><span class=\"token number\">192.168</span><span class=\"token number\">.137</span><span class=\"token number\">.1</span>      </span><span class=\"token comment\">/* server ip */</span></span></pre></td></tr><tr><td data-num=\"309\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_GATEWAYIP</span>    <span class=\"token expression\"><span class=\"token number\">192.168</span><span class=\"token number\">.137</span><span class=\"token number\">.1</span>        </span><span class=\"token comment\">/* board gateway ip */</span></span></pre></td></tr><tr><td data-num=\"310\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">CONFIG_NETMASK</span>      <span class=\"token expression\"><span class=\"token number\">255.255</span><span class=\"token number\">.255</span><span class=\"token number\">.0</span>       </span><span class=\"token comment\">/* board netmask */</span></span></pre></td></tr><tr><td data-num=\"311\"></td><td><pre></pre></td></tr><tr><td data-num=\"312\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr></table></figure><p>以上添加了网络信息配置，因为在  <code>mx6ull_14x14_lanjut_emmc_defconfig</code>  中，我们有移除 DHCP 命令操作，因此如果使用到网络，那么必然需要配置静态网络  <code>setenv ipaddr</code>  这些，而在这里我们直接先配置好默认 ip（即  <code>/* Network Configs */</code>  下的操作）。同样，在这里可以找到与 NAND、IIC、SPI、VIDEO 这些不需要的功能，部分通过  <code>#ifdef</code>  宏来启用，那么如果在  <code>mx6ull_14x14_lanjut_emmc_defconfig</code>  中有屏蔽相应的宏则不要处理，否则对于一些没有在  <code>mx6ull_14x14_lanjut_emmc_defconfig</code>  中出现的并且想要裁切的功能，可以直接屏蔽对应的宏（例如是对  <code>board/freescale/mx6ull_lanjut/mx6ull_lanjut.c</code>  中的操作选择）。</p>\n<h1 id=\"添加编译脚本\"><a class=\"anchor\" href=\"#添加编译脚本\">#</a> 添加编译脚本</h1>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">touch</span> build.sh</pre></td></tr><tr><td data-num=\"2\"></td><td data-command=\"[root@localhost] $\"></td><td><pre><span class=\"token function\">vim</span> build.sh</pre></td></tr></table></figure><p><strong>写入：</strong></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token shebang important\">#!/bin/bash</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 若之前已经导入到环境变量则不需要</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token environment constant\">$PATH</span>:/usr/local/arm/gcc-arm-10.3-2021.07-x86_64-arm-none-linux-gnueabihf/bin</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># 若已经在顶层 Makefile 文件中指定则不需要</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">ARCH</span><span class=\"token operator\">=</span>arm</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># 若已经在顶层 Makefile 文件中指定则不需要</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">CROSS_COMPILE</span><span class=\"token operator\">=</span>arm-none-linux-gnueabihf-</pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">LCPU</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token function\">grep</span> <span class=\"token parameter variable\">-c</span> processor /proc/cpuinfo<span class=\"token variable\">`</span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token function\">make</span> clean</pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">make</span> mx6ull_14x14_lanjut_emmc_defconfig</pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token function\">make</span> -j<span class=\"token variable\">$&#123;LCPU&#125;</span></pre></td></tr></table></figure><h1 id=\"附\"><a class=\"anchor\" href=\"#附\">#</a> 附</h1>\n<p>uboot 文件结构：</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">类型</th>\n<th style=\"text-align:center\">名称</th>\n<th style=\"text-align:center\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\" rowspan=\"21\">文件夹</td>\n<td style=\"text-align:center\">api</td>\n<td style=\"text-align:center\">通用的 API 函数相关</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">arch</td>\n<td style=\"text-align:center\">与芯片架构相关</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">board</td>\n<td style=\"text-align:center\">板级相关信息</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">cmd</td>\n<td style=\"text-align:center\">uboot 命令相关</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">common</td>\n<td style=\"text-align:center\">通用代码</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">configs</td>\n<td style=\"text-align:center\">uboot 配置内容</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">disk</td>\n<td style=\"text-align:center\">磁盘相关</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">doc</td>\n<td style=\"text-align:center\">各说明文档</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">drivers</td>\n<td style=\"text-align:center\">驱动代码相关</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">dts</td>\n<td style=\"text-align:center\">设备树相关</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">env</td>\n<td style=\"text-align:center\">uboot 环境相关</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">examples</td>\n<td style=\"text-align:center\">示例代码</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">fs</td>\n<td style=\"text-align:center\">文件系统相关</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">include</td>\n<td style=\"text-align:center\">头文件相关</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">lib</td>\n<td style=\"text-align:center\">lib 库文件</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Licenses</td>\n<td style=\"text-align:center\">许可证相关</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">net</td>\n<td style=\"text-align:center\">网络相关</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">post</td>\n<td style=\"text-align:center\">上电自检相关</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">scripts</td>\n<td style=\"text-align:center\">相关脚本</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">test</td>\n<td style=\"text-align:center\">测试代码</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">tools</td>\n<td style=\"text-align:center\">uboot 构建工具相关</td>\n</tr>\n<tr>\n<td style=\"text-align:center\" rowspan=\"6\">文件</td>\n<td style=\"text-align:center\"><span class=\"exturl\" data-url=\"aHR0cDovL2NvbmZpZy5taw==\">config.mk</span></td>\n<td style=\"text-align:center\">某个 Makefile 需要调用此文件</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Kbuild</td>\n<td style=\"text-align:center\">用于生成汇编相关的文件</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Kconfig</td>\n<td style=\"text-align:center\">图形配置界面相关文件</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">MAINTAINERS</td>\n<td style=\"text-align:center\">开发及维护记录</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Makefile</td>\n<td style=\"text-align:center\">主 Makefile 脚本</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">README</td>\n<td style=\"text-align:center\">工程说明</td>\n</tr>\n</tbody>\n</table>\n",
            "tags": [
                "Linux",
                "arm_linux",
                "imx6ull"
            ]
        }
    ]
}